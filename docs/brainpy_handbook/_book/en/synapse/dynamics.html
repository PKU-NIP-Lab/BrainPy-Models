
<!DOCTYPE HTML>
<html lang="en" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>2.1 Synaptic dynamics Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-katex/katex.min.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-code/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-anchor-navigation-ex/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="plasticity.html" />
    
    
    <link rel="prev" href="../synapses.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    0. Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../neurons.html">
            
                <a href="../neurons.html">
            
                    
                    1. Neuron models
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../neurons/biophysical_models.html">
            
                <a href="../neurons/biophysical_models.html">
            
                    
                    1.1 Biophysical models
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../neurons/reduced_models.html">
            
                <a href="../neurons/reduced_models.html">
            
                    
                    1.2 Reduced models
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../neurons/firing_rate_models.html">
            
                <a href="../neurons/firing_rate_models.html">
            
                    
                    1.3 Firing rate models
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../synapses.html">
            
                <a href="../synapses.html">
            
                    
                    2. Synapse models
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.3.1" data-path="dynamics.html">
            
                <a href="dynamics.html">
            
                    
                    2.1 Synaptic dynamics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="plasticity.html">
            
                <a href="plasticity.html">
            
                    
                    2.2 Synaptic plasticity
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../networks.html">
            
                <a href="../networks.html">
            
                    
                    3. Network models
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../networks/snn.html">
            
                <a href="../networks/snn.html">
            
                    
                    3.1 Spiking neural networks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../networks/rate_models.html">
            
                <a href="../networks/rate_models.html">
            
                    
                    3.2 Firing rate networks
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >2.1 Synaptic dynamics</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div id="anchor-navigation-ex-navbar"><i class="fa fa-navicon"></i><ul><ul><li><span class="title-icon "></span><a href="#21-synaptic-dynamics"><b></b>2.1 Synaptic Dynamics</a></li><ul><li><span class="title-icon "></span><a href="#211-chemical-synapses"><b></b>2.1.1 Chemical Synapses</a></li><li><span class="title-icon "></span><a href="#212-electrical-synapses"><b></b>2.1.2 Electrical Synapses</a></li></ul></ul></ul></div><a href="#" id="anchorNavigationExGoTop"><i class="fa fa-arrow-up"></i></a><h2 id="21-synaptic-dynamics"><a name="21-synaptic-dynamics" class="anchor-navigation-ex-anchor" href="#21-synaptic-dynamics"><i class="fa fa-link" aria-hidden="true"></i></a>2.1 Synaptic Dynamics</h2>
<p>When we model the firing of neurons, we need to connect them. Synapse is very important for the communication between neurons, and it is an essential component of the formation of the network. Therefore, we need to model the synapse.</p>
<p>In this section, we will introduce how to implement synaptic dynamics with BrainPy.</p>
<h3 id="211-chemical-synapses"><a name="211-chemical-synapses" class="anchor-navigation-ex-anchor" href="#211-chemical-synapses"><i class="fa fa-link" aria-hidden="true"></i></a>2.1.1 Chemical Synapses</h3>
<h4 id="ampa-synapse"><a name="ampa-synapse" class="anchor-navigation-ex-anchor" href="#ampa-synapse"><i class="fa fa-link" aria-hidden="true"></i></a>AMPA Synapse</h4>
<p>The picture shows the biological process of information transmission between neurons. Neurotransmitters released by presynaptic neurons bind with receptors on postsynaptic neurons, thus opening ion channels on the cell membrane of postsynaptic neurons and causing changes in membrane potential. Here we first introduce a typical synapse with AMPA receptor, and then introduce how to implement it with BrainPy.</p>
<p><img src="../../figs/bio_syn.png"></p>
<p>AMPA receptor is an ionotropic receptor, which is an ion channel. When it is bound by neurotransmitters, it will immediately open the ion channel, causing the change of membrane potential of postsynaptic neurons.</p>
<p>A classical model is to use the Markov process to model ion channel switch. Here <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">s</span></span></span></span> represents the probability of channel opening, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mo>&#x2212;</mo><mi>s</mi></mrow><annotation encoding="application/x-tex">1-s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mbin">&#x2212;</span><span class="mord mathit">s</span></span></span></span> represents the probability of ion channel closing, and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B1;</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.0037em;">&#x3B1;</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B2;</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05278em;">&#x3B2;</span></span></span></span> are the transition probability. Because neurotransmitters can open ion channels, the transfer probability from <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mo>&#x2212;</mo><mi>s</mi></mrow><annotation encoding="application/x-tex">1-s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mbin">&#x2212;</span><span class="mord mathit">s</span></span></span></span> to <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">s</span></span></span></span> is affected by the concentration of neurotransmitters. We denote the concentration of neurotransmitters as [T] and get the following Markov process.</p>
<p><img src="../../figs/markov.png" style="zoom: 25%;"></p>
<p>We obtained the following formula when describing the process by a differential equation.</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi>d</mi><mi>s</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mi>&#x3B1;</mi><mo>[</mo><mi>T</mi><mo>]</mo><mo>(</mo><mn>1</mn><mo>&#x2212;</mo><mi>s</mi><mo>)</mo><mo>&#x2212;</mo><mi>&#x3B2;</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">
\frac {ds}{dt} = \alpha [T] (1-s) - \beta s
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">d</span><span class="mord mathit">t</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">d</span><span class="mord mathit">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.0037em;">&#x3B1;</span><span class="mopen">[</span><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mclose">]</span><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mbin">&#x2212;</span><span class="mord mathit">s</span><span class="mclose">)</span><span class="mbin">&#x2212;</span><span class="mord mathit" style="margin-right:0.05278em;">&#x3B2;</span><span class="mord mathit">s</span></span></span></span></span></p>
<p>Where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B1;</mi><mo>[</mo><mi>T</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">\alpha [T]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.0037em;">&#x3B1;</span><span class="mopen">[</span><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mclose">]</span></span></span></span> denotes the transition probability from state <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mn>1</mn><mo>&#x2212;</mo><mi>s</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(1-s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mbin">&#x2212;</span><span class="mord mathit">s</span><span class="mclose">)</span></span></span></span> to state <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>s</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathit">s</span><span class="mclose">)</span></span></span></span>; and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B2;</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05278em;">&#x3B2;</span></span></span></span> represents the transition probability of the other direction.</p>
<p>Now let&apos;s see how to implement such a model with BrainPy. First of all, we need to define a class that inherits from<code>bp.TwoEndConn</code>, because synapses connect two neurons.</p>
<p>To define this class, we first use the<code>__ init__</code>Function to initialize the required parameters and variables. First, in a synapse, we need <code>pre</code> and <code>post</code> to specify the presynaptic neurons and postsynaptic neurons connected by the synapse, respectively. It should be noted that both <code>pre</code> and <code>post</code> are vectors, representing two groups of neurons. Therefore, we also need to specify the <code>conn</code> of the connection matrix between the two neuron groups. Here, we can get the connection matrix <code>conn</code> from <code>conn_ mat</code>.</p>
<p>Now that we know how to define a synaptic model in BrainPy, let&apos;s focus on how to implement an AMPA synapse. We notice that there is a concentration of neurotransmitter [T] in the formula. In order to simplify the calculation, [T] can be regarded as a constant, which is determined by <code>T_duration</code> controls how long it lasts. Therefore, our simplified implementation is that every time the presynaptic neuron emits, it will release neurotransmitters, which maintain <code>T_duration</code>, then is cleared. So we just need to judge if it&apos;s at <code>T_duration</code>, then [T] = T, otherwise [T] = 0. Then the judgment process needs to use a variable <code>t_last_pre_spike</code> to record the last firing time of presynaptic neurons.</p>
<p>After initialization, we copy the right side of the differential equation to the <code>derivative</code> function, and then update [T] and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">s</span></span></span></span> in the <code>update</code> function.</p>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> brainpy <span class="hljs-keyword">as</span> bp
bp.backend.set(backend=<span class="hljs-string">&apos;numpy&apos;</span>, dt=<span class="hljs-number">0.1</span>)

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AMPA</span><span class="hljs-params">(bp.TwoEndConn)</span>:</span>
    target_backend = <span class="hljs-string">&apos;general&apos;</span>

<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">derivative</span><span class="hljs-params">(s, t, TT, alpha, beta)</span>:</span>
        ds = alpha * TT * (<span class="hljs-number">1</span> - s) - beta * s 
        <span class="hljs-keyword">return</span> ds

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, pre, post, conn, alpha=<span class="hljs-number">0.98</span>,
                 beta=<span class="hljs-number">0.18</span>, T=<span class="hljs-number">0.5</span>, T_duration=<span class="hljs-number">0.5</span>,
                 **kwargs)</span>:</span>
        <span class="hljs-comment"># parameters</span>
        self.alpha = alpha
        self.beta = beta
        self.T = T
        self.T_duration = T_duration

        <span class="hljs-comment"># connections</span>
        self.conn = conn(pre.size, post.size)
        self.conn_mat = conn.requires(<span class="hljs-string">&apos;conn_mat&apos;</span>)
        self.size = bp.ops.shape(self.conn_mat)

        <span class="hljs-comment"># variable</span>
        self.s = bp.ops.zeros(self.size)
        self.t_last_pre_spike = <span class="hljs-number">-1e7</span> * bp.ops.ones(self.size)

        self.int_s = bp.odeint(f=self.derivative, method=<span class="hljs-string">&apos;exponential_euler&apos;</span>)

        super(AMPA, self).__init__(pre=pre, post=post, **kwargs)



    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span><span class="hljs-params">(self, _t)</span>:</span>
        spike = bp.ops.unsqueeze(self.pre.spike, <span class="hljs-number">1</span>) * self.conn_mat
        self.t_last_pre_spike = bp.ops.where(spike, _t, self.t_last_pre_spike)
        TT = ((_t - self.t_last_pre_spike) &lt; self.T_duration) * self.T
        self.s = self.int_s(self.s, _t, TT, self.alpha, self.beta)
</code></pre>
<p>After the implementation, we can plot the graph of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">s</span></span></span></span> changing with time.</p>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> brainmodels <span class="hljs-keyword">as</span> bm

neu1 = bm.neurons.LIF(<span class="hljs-number">2</span>, monitors=[<span class="hljs-string">&apos;V&apos;</span>])
neu2 = bm.neurons.LIF(<span class="hljs-number">3</span>, monitors=[<span class="hljs-string">&apos;V&apos;</span>])
syn = AMPA(T_duration=<span class="hljs-number">3.</span>,pre=neu1, post=neu2, conn=bp.connect.All2All(), monitors=[<span class="hljs-string">&apos;s&apos;</span>])

net = bp.Network(neu1, syn, neu2)
net.run(<span class="hljs-number">30.</span>, inputs=(neu1, <span class="hljs-string">&apos;input&apos;</span>, <span class="hljs-number">35.</span>))
bp.visualize.line_plot(net.ts, syn.mon.s, ylabel=<span class="hljs-string">&apos;s&apos;</span>, show=<span class="hljs-keyword">True</span>)
</code></pre>
<p><img src="../../figs/out/output_9_0.png" alt="png"></p>
<p>As can be seen from the above figure, when the presynaptic neurons fire, the value of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">s</span></span></span></span> will first increase, and then decay.</p>
<h4 id="alpha&#x3001;exponential-synapses"><a name="alpha&#x3001;exponential-synapses" class="anchor-navigation-ex-anchor" href="#alpha&#x3001;exponential-synapses"><i class="fa fa-link" aria-hidden="true"></i></a>Alpha&#x3001;Exponential Synapses</h4>
<p>Because many synaptic models have the same dynamic characteristics as AMPA synapses, sometimes we don&apos;t need to use models that specifically correspond to biological synapses. Therefore, some abstract synaptic models have been proposed. Here, we will introduce the implementation of four abstract models on BrainPy. These models are also available in the <code>Brain-Models</code> package.</p>
<h5 id="1-differences-of-two-exponentials"><a name="1-differences-of-two-exponentials" class="anchor-navigation-ex-anchor" href="#1-differences-of-two-exponentials"><i class="fa fa-link" aria-hidden="true"></i></a>(1) Differences of two exponentials</h5>
<p>The first is <code>Differences of two exponentials</code>, the dynamic is given by,</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mo>=</mo><mfrac><mrow><msub><mi>&#x3C4;</mi><mn>1</mn></msub><msub><mi>&#x3C4;</mi><mn>2</mn></msub></mrow><mrow><msub><mi>&#x3C4;</mi><mn>1</mn></msub><mo>&#x2212;</mo><msub><mi>&#x3C4;</mi><mn>2</mn></msub></mrow></mfrac><mo>(</mo><mi>exp</mi><mo>(</mo><mo>&#x2212;</mo><mfrac><mrow><mi>t</mi><mo>&#x2212;</mo><msub><mi>t</mi><mi>s</mi></msub></mrow><mrow><msub><mi>&#x3C4;</mi><mn>1</mn></msub></mrow></mfrac><mo>)</mo><mo>&#x2212;</mo><mi>exp</mi><mo>(</mo><mo>&#x2212;</mo><mfrac><mrow><mi>t</mi><mo>&#x2212;</mo><msub><mi>t</mi><mi>s</mi></msub></mrow><mrow><msub><mi>&#x3C4;</mi><mn>2</mn></msub></mrow></mfrac><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">
s = \frac {\tau_1 \tau_2}{\tau_1 - \tau_2} (\exp(-\frac{t - t_s}{\tau_1})
- \exp(-\frac{t - t_s}{\tau_2}))
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.29208em;"></span><span class="strut bottom" style="height:2.1280799999999997em;vertical-align:-0.8360000000000001em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">s</span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.1132em;">&#x3C4;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.1132em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord mathit" style="margin-right:0.1132em;">&#x3C4;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.1132em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.1132em;">&#x3C4;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.1132em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.1132em;">&#x3C4;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.1132em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mopen">(</span><span class="mop">exp</span><span class="mopen">(</span><span class="mord">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.1132em;">&#x3C4;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.1132em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">t</span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose">)</span><span class="mbin">&#x2212;</span><span class="mop">exp</span><span class="mopen">(</span><span class="mord">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.1132em;">&#x3C4;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.1132em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">t</span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></p>
<p>While implementing with BrainPy, we use the following differential equation form,</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi>d</mi><mi>s</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">
		\frac {ds} {dt} = x
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">d</span><span class="mord mathit">t</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">d</span><span class="mord mathit">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mrel">=</span><span class="mord mathit">x</span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi>d</mi><mi>x</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mo>&#x2212;</mo><mfrac><mrow><msub><mi>&#x3C4;</mi><mn>1</mn></msub><mo>+</mo><msub><mi>&#x3C4;</mi><mn>2</mn></msub></mrow><mrow><msub><mi>&#x3C4;</mi><mn>1</mn></msub><msub><mi>&#x3C4;</mi><mn>2</mn></msub></mrow></mfrac><mi>x</mi><mo>&#x2212;</mo><mfrac><mi>s</mi><mrow><msub><mi>&#x3C4;</mi><mn>1</mn></msub><msub><mi>&#x3C4;</mi><mn>2</mn></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">
 \frac {dx}{dt} =- \frac{\tau_1+\tau_2}{\tau_1 \tau_2}x - \frac s {\tau_1 \tau_2}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.20744em;vertical-align:-0.8360000000000001em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">d</span><span class="mord mathit">t</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">d</span><span class="mord mathit">x</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mrel">=</span><span class="mord">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.1132em;">&#x3C4;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.1132em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.1132em;">&#x3C4;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.1132em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.1132em;">&#x3C4;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.1132em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.1132em;">&#x3C4;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.1132em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord mathit">x</span><span class="mbin">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.1132em;">&#x3C4;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.1132em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.1132em;">&#x3C4;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.1132em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord mathit">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mtext>&#xA0;</mtext><mi mathvariant="normal">(</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">)</mi><mi mathvariant="normal">,</mi><mtext>&#xA0;</mtext><mi mathvariant="normal">t</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi></mtext><mtext>&#xA0;</mtext><mi>x</mi><mo>&#x2190;</mo><mi>x</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">
\text{if (fire), then} \ x \leftarrow x+ 1
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord text displaystyle textstyle uncramped"><span class="mord mathrm">if&#xA0;(fire),&#xA0;then</span></span><span class="mord mathit"><span class="mspace">&#xA0;</span><span class="mord mathit">x</span></span><span class="mrel">&#x2190;</span><span class="mord mathit">x</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span></span></p>
<p>Here we specify the logic of increment of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span></span></span></span> in the <code>Update</code> function when the presynaptic neurons fire. The code is as follows:</p>
<pre><code class="lang-python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Two_exponentials</span><span class="hljs-params">(bp.TwoEndConn)</span>:</span>
    target_backend = <span class="hljs-string">&apos;general&apos;</span>

<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">derivative</span><span class="hljs-params">(s, x, t, tau1, tau2)</span>:</span>
        dxdt = (-(tau1 + tau2) * x - s) / (tau1 * tau2)
        dsdt = x
        <span class="hljs-keyword">return</span> dsdt, dxdt

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, pre, post, conn, tau1=<span class="hljs-number">1.0</span>, tau2=<span class="hljs-number">3.0</span>, **kwargs)</span>:</span>
        <span class="hljs-comment"># parameters</span>
        self.tau1 = tau1
        self.tau2 = tau2

        <span class="hljs-comment"># connections</span>
        self.conn = conn(pre.size, post.size)
        self.conn_mat = conn.requires(<span class="hljs-string">&apos;conn_mat&apos;</span>)
        self.size = bp.ops.shape(self.conn_mat)

        <span class="hljs-comment"># variables</span>
        self.s = bp.ops.zeros(self.size)
        self.x = bp.ops.zeros(self.size)

        self.integral = bp.odeint(f=self.derivative, method=<span class="hljs-string">&apos;rk4&apos;</span>)

        super(Two_exponentials, self).__init__(pre=pre, post=post, **kwargs)

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span><span class="hljs-params">(self, _t)</span>:</span>
        self.s, self.x = self.integral(self.s, self.x, _t, self.tau1, self.tau2)
        self.x += bp.ops.unsqueeze(self.pre.spike, <span class="hljs-number">1</span>) * self.conn_mat
</code></pre>
<pre><code class="lang-python">neu1 = bm.neurons.LIF(<span class="hljs-number">2</span>, monitors=[<span class="hljs-string">&apos;V&apos;</span>])
neu2 = bm.neurons.LIF(<span class="hljs-number">3</span>, monitors=[<span class="hljs-string">&apos;V&apos;</span>])
syn = Two_exponentials(tau1=<span class="hljs-number">2.</span>, pre=neu1, post=neu2, conn=bp.connect.All2All(), monitors=[<span class="hljs-string">&apos;s&apos;</span>])

net = bp.Network(neu1, syn, neu2)
net.run(<span class="hljs-number">30.</span>, inputs=(neu1, <span class="hljs-string">&apos;input&apos;</span>, <span class="hljs-number">35.</span>))
bp.visualize.line_plot(net.ts, syn.mon.s, ylabel=<span class="hljs-string">&apos;s&apos;</span>, show=<span class="hljs-keyword">True</span>)
</code></pre>
<p><img src="../../figs/out/output_16_0.png" alt="png"></p>
<h5 id="2-alpha-synapse"><a name="2-alpha-synapse" class="anchor-navigation-ex-anchor" href="#2-alpha-synapse"><i class="fa fa-link" aria-hidden="true"></i></a>(2) Alpha synapse</h5>
<p><code>Alpha synapse</code> is similar to the above model, except here <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>&#x3C4;</mi><mn>1</mn></msub><mo>=</mo><msub><mi>&#x3C4;</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\tau_1 = \tau_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.1132em;">&#x3C4;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.1132em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.1132em;">&#x3C4;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.1132em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>. Therefore, the formula is more simplified:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi>d</mi><mi>s</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">
\frac {ds} {dt} = x
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">d</span><span class="mord mathit">t</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">d</span><span class="mord mathit">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mrel">=</span><span class="mord mathit">x</span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi>d</mi><mi>x</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mo>&#x2212;</mo><mfrac><mrow><mn>2</mn><mi>x</mi></mrow><mrow><mi>&#x3C4;</mi></mrow></mfrac><mo>&#x2212;</mo><mfrac><mi>s</mi><mrow><msup><mi>&#x3C4;</mi><mn>2</mn></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">
 \frac {dx}{dt} =- \frac{2x}{\tau} - \frac s {\tau^2}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">d</span><span class="mord mathit">t</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">d</span><span class="mord mathit">x</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mrel">=</span><span class="mord">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit" style="margin-right:0.1132em;">&#x3C4;</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">2</span><span class="mord mathit">x</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mbin">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.1132em;">&#x3C4;</span><span class="msupsub"><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord mathit">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mtext>&#xA0;</mtext><mi mathvariant="normal">(</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">)</mi><mi mathvariant="normal">,</mi><mtext>&#xA0;</mtext><mi mathvariant="normal">t</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi></mtext><mtext>&#xA0;</mtext><mi>x</mi><mo>&#x2190;</mo><mi>x</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">
\text{if (fire), then} \ x \leftarrow x+ 1
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord text displaystyle textstyle uncramped"><span class="mord mathrm">if&#xA0;(fire),&#xA0;then</span></span><span class="mord mathit"><span class="mspace">&#xA0;</span><span class="mord mathit">x</span></span><span class="mrel">&#x2190;</span><span class="mord mathit">x</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span></span></p>
<p>Code implementation is similar:</p>
<pre><code class="lang-python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Alpha</span><span class="hljs-params">(bp.TwoEndConn)</span>:</span>
    target_backend = <span class="hljs-string">&apos;general&apos;</span>

<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">derivative</span><span class="hljs-params">(s, x, t, tau)</span>:</span>
        dxdt = (<span class="hljs-number">-2</span> * tau * x - s) / (tau ** <span class="hljs-number">2</span>)
        dsdt = x
        <span class="hljs-keyword">return</span> dsdt, dxdt

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, pre, post, conn, tau=<span class="hljs-number">3.0</span>, **kwargs)</span>:</span>
        <span class="hljs-comment"># parameters</span>
        self.tau = tau

        <span class="hljs-comment"># connections</span>
        self.conn = conn(pre.size, post.size)
        self.conn_mat = conn.requires(<span class="hljs-string">&apos;conn_mat&apos;</span>)
        self.size = bp.ops.shape(self.conn_mat)

        <span class="hljs-comment"># variables</span>
        self.s = bp.ops.zeros(self.size)
        self.x = bp.ops.zeros(self.size)

        self.integral = bp.odeint(f=self.derivative, method=<span class="hljs-string">&apos;rk4&apos;</span>)

        super(Alpha, self).__init__(pre=pre, post=post, **kwargs)

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span><span class="hljs-params">(self, _t)</span>:</span>
        self.s, self.x = self.integral(self.s, self.x, _t, self.tau)
        self.x += bp.ops.unsqueeze(self.pre.spike, <span class="hljs-number">1</span>) * self.conn_mat
</code></pre>
<pre><code class="lang-python">neu1 = bm.neurons.LIF(<span class="hljs-number">2</span>, monitors=[<span class="hljs-string">&apos;V&apos;</span>])
neu2 = bm.neurons.LIF(<span class="hljs-number">3</span>, monitors=[<span class="hljs-string">&apos;V&apos;</span>])
syn = Alpha(pre=neu1, post=neu2, conn=bp.connect.All2All(), monitors=[<span class="hljs-string">&apos;s&apos;</span>])

net = bp.Network(neu1, syn, neu2)
net.run(<span class="hljs-number">30.</span>, inputs=(neu1, <span class="hljs-string">&apos;input&apos;</span>, <span class="hljs-number">35.</span>))
bp.visualize.line_plot(net.ts, syn.mon.s, ylabel=<span class="hljs-string">&apos;s&apos;</span>, show=<span class="hljs-keyword">True</span>)
</code></pre>
<p><img src="../../figs/out/output_20_0.png" alt="png"></p>
<h5 id="3-single-exponential-decay"><a name="3-single-exponential-decay" class="anchor-navigation-ex-anchor" href="#3-single-exponential-decay"><i class="fa fa-link" aria-hidden="true"></i></a>(3) Single exponential decay</h5>
<p>Sometimes we can ignore the rising process in modeling, and only need to model the decay process. Therefore, the formula of <code>single exponential decay</code> model is more simplified:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi>d</mi><mi>s</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mo>&#x2212;</mo><mfrac><mi>s</mi><mrow><msub><mi>&#x3C4;</mi><mrow><mi>d</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>y</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">
\frac {ds}{dt}=-\frac s {\tau_{decay}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.343548em;vertical-align:-0.972108em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">d</span><span class="mord mathit">t</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">d</span><span class="mord mathit">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mrel">=</span><span class="mord">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.6859999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.1132em;">&#x3C4;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.1132em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">d</span><span class="mord mathit mtight">e</span><span class="mord mathit mtight">c</span><span class="mord mathit mtight">a</span><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord mathit">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mtext>&#xA0;</mtext><mi mathvariant="normal">(</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">)</mi><mi mathvariant="normal">,</mi><mtext>&#xA0;</mtext><mi mathvariant="normal">t</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi></mtext><mtext>&#xA0;</mtext><mi>s</mi><mo>&#x2190;</mo><mi>s</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">
\text{if (fire), then} \ s \leftarrow s+1
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord text displaystyle textstyle uncramped"><span class="mord mathrm">if&#xA0;(fire),&#xA0;then</span></span><span class="mord mathit"><span class="mspace">&#xA0;</span><span class="mord mathit">s</span></span><span class="mrel">&#x2190;</span><span class="mord mathit">s</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span></span></p>
<p>The implementing code is given by:</p>
<pre><code class="lang-python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Exponential</span><span class="hljs-params">(bp.TwoEndConn)</span>:</span>
    target_backend = <span class="hljs-string">&apos;general&apos;</span>

<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">derivative</span><span class="hljs-params">(s, t, tau)</span>:</span>
        ds = -s / tau
        <span class="hljs-keyword">return</span> ds

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, pre, post, conn, tau=<span class="hljs-number">8.0</span>, **kwargs)</span>:</span>
        <span class="hljs-comment"># parameters</span>
        self.tau = tau

        <span class="hljs-comment"># connections</span>
        self.conn = conn(pre.size, post.size)
        self.conn_mat = conn.requires(<span class="hljs-string">&apos;conn_mat&apos;</span>)
        self.size = bp.ops.shape(self.conn_mat)

        <span class="hljs-comment"># variables</span>
        self.s = bp.ops.zeros(self.size)

        self.integral = bp.odeint(f=self.derivative, method=<span class="hljs-string">&apos;exponential_euler&apos;</span>)

        super(Exponential, self).__init__(pre=pre, post=post, **kwargs)


    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span><span class="hljs-params">(self, _t)</span>:</span>
        self.s = self.integral(self.s, _t, self.tau)
        self.s += bp.ops.unsqueeze(self.pre.spike, <span class="hljs-number">1</span>) * self.conn_mat
</code></pre>
<pre><code class="lang-python">neu1 = bm.neurons.LIF(<span class="hljs-number">2</span>, monitors=[<span class="hljs-string">&apos;V&apos;</span>])
neu2 = bm.neurons.LIF(<span class="hljs-number">3</span>, monitors=[<span class="hljs-string">&apos;V&apos;</span>])
syn = Exponential(pre=neu1, post=neu2, conn=bp.connect.All2All(), monitors=[<span class="hljs-string">&apos;s&apos;</span>])

net = bp.Network(neu1, syn, neu2)
net.run(<span class="hljs-number">30.</span>, inputs=(neu1, <span class="hljs-string">&apos;input&apos;</span>, <span class="hljs-number">35.</span>))
bp.visualize.line_plot(net.ts, syn.mon.s, ylabel=<span class="hljs-string">&apos;s&apos;</span>, show=<span class="hljs-keyword">True</span>)
</code></pre>
<p><img src="../../figs/out/output_24_0.png" alt="png"></p>
<h5 id="&#xFF08;4&#xFF09;voltage-jump"><a name="&#xFF08;4&#xFF09;voltage-jump" class="anchor-navigation-ex-anchor" href="#&#xFF08;4&#xFF09;voltage-jump"><i class="fa fa-link" aria-hidden="true"></i></a>&#xFF08;4&#xFF09;Voltage jump</h5>
<p>Sometimes even the decay process can be ignored, so there is a <code>voltage jump</code> model, which is given by:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mtext>&#xA0;</mtext><mi mathvariant="normal">(</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">)</mi><mi mathvariant="normal">,</mi><mtext>&#xA0;</mtext><mi mathvariant="normal">t</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi></mtext><mtext>&#xA0;</mtext><mi>V</mi><mo>&#x2190;</mo><mi>V</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">
\text{if (fire), then} \ V \leftarrow V+1
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord text displaystyle textstyle uncramped"><span class="mord mathrm">if&#xA0;(fire),&#xA0;then</span></span><span class="mord mathit"><span class="mspace">&#xA0;</span><span class="mord mathit" style="margin-right:0.22222em;">V</span></span><span class="mrel">&#x2190;</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span></span></p>
<p>In the implementation, even the differential equation is not needed, just update the postsynaptic membrane potential in the <code>update</code> function. However, because it will directly modify the membrane potential, when the postsynaptic neurons have a refractory period, it should only update the membrane potential while not in the refractory period.</p>
<p>The code is as follows:</p>
<pre><code class="lang-python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Voltage_jump</span><span class="hljs-params">(bp.TwoEndConn)</span>:</span>        
    target_backend = <span class="hljs-string">&apos;general&apos;</span>

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, pre, post, conn, post_refractory=False,  **kwargs)</span>:</span>
        <span class="hljs-comment"># parameters</span>
        self.post_refractory = post_refractory

        <span class="hljs-comment"># connections</span>
        self.conn = conn(pre.size, post.size)
        self.conn_mat = conn.requires(<span class="hljs-string">&apos;conn_mat&apos;</span>)
        self.size = bp.ops.shape(self.conn_mat)

        <span class="hljs-comment"># variables</span>
        self.s = bp.ops.zeros(self.size)

        super(Voltage_jump, self).__init__(pre=pre, post=post, **kwargs)

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span><span class="hljs-params">(self, _t)</span>:</span>
        self.s = bp.ops.unsqueeze(self.pre.spike, <span class="hljs-number">1</span>) * self.conn_mat

        <span class="hljs-keyword">if</span> self.post_refractory:
            refra_map = (<span class="hljs-number">1.</span> - bp.ops.unsqueeze(self.post.refractory, <span class="hljs-number">0</span>)) * self.conn_mat
            self.post.V += bp.ops.sum(self.s * refra_map, axis=<span class="hljs-number">0</span>)
        <span class="hljs-keyword">else</span>:
            self.post.V += bp.ops.sum(self.s, axis=<span class="hljs-number">0</span>)
</code></pre>
<pre><code class="lang-python">neu1 = bm.neurons.LIF(<span class="hljs-number">2</span>, monitors=[<span class="hljs-string">&apos;V&apos;</span>])
neu2 = bm.neurons.LIF(<span class="hljs-number">3</span>, monitors=[<span class="hljs-string">&apos;V&apos;</span>])
syn = Voltage_jump(pre=neu1, post=neu2, conn=bp.connect.All2All(), monitors=[<span class="hljs-string">&apos;s&apos;</span>])

net = bp.Network(neu1, syn, neu2)
net.run(<span class="hljs-number">30.</span>, inputs=(neu1, <span class="hljs-string">&apos;input&apos;</span>, <span class="hljs-number">35.</span>))
bp.visualize.line_plot(net.ts, syn.mon.s, ylabel=<span class="hljs-string">&apos;s&apos;</span>, show=<span class="hljs-keyword">True</span>)
</code></pre>
<p><img src="../../figs/out/output_28_0.png" alt="png"></p>
<h4 id="current-based-and-conductance-based-synapse"><a name="current-based-and-conductance-based-synapse" class="anchor-navigation-ex-anchor" href="#current-based-and-conductance-based-synapse"><i class="fa fa-link" aria-hidden="true"></i></a>Current-based and Conductance-based synapse</h4>
<p>Previously, we have modeled the gating variable <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">s</span></span></span></span>. There are two different methods to model the relationships of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">s</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07847em;">I</span></span></span></span> (the input current of postsynaptic neurons): <strong>current-based</strong> and <strong>conductance-based</strong>. The main difference between them is whether the synaptic current is influenced by the membrane potential of postsynaptic neurons.</p>
<p>The formula of the current-based model is as follow:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>I</mi><mo>&#x221D;</mo><mi>s</mi></mrow><annotation encoding="application/x-tex">
I \propto s
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="mrel">&#x221D;</span><span class="mord mathit">s</span></span></span></span></span></p>
<p>While coding, we usually multiply <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">s</span></span></span></span> by a weight <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span></span>. We can implement excitatory and inhibitory synapses by adjusting the positive and negative values of the weight <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span></span>.</p>
<p>Here implement the delay of synapses by applying a delay time to <code>I_syn</code> variable with the <code>register_constant_delay</code> function provided by BrainPy.</p>
<pre><code class="lang-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, pre, post, conn, **kwargs)</span>:</span>
    <span class="hljs-comment"># ...</span>
    self.s = bp.ops.zeros(self.size)
    self.w = bp.ops.ones(self.size) * <span class="hljs-number">.2</span>
    self.I_syn = self.register_constant_delay(<span class="hljs-string">&apos;I_syn&apos;</span>, size=self.size, delay_time=delay)

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span><span class="hljs-params">(self, _t)</span>:</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> nb.prange(self.size):
        <span class="hljs-comment"># ... </span>
        self.I_syn.push(i, self.w[i] * self.s[i])
        self.post.input[post_id] += self.I_syn.pull(i)
</code></pre>
<p>In the conductance-based model, the conductance is <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mo>=</mo><mover accent="true"><mrow><mi>g</mi></mrow><mo>&#xAF;</mo></mover><mi>s</mi></mrow><annotation encoding="application/x-tex">g=\bar{g} s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.56778em;"></span><span class="strut bottom" style="height:0.7622199999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mrel">=</span><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord textstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">g</span></span></span><span style="top:0em;margin-left:0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mord mathit">s</span></span></span></span>. Therefore, according to Ohm&apos;s law, the formula is given by:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>I</mi><mo>=</mo><mover accent="true"><mrow><mi>g</mi></mrow><mo>&#xAF;</mo></mover><mi>s</mi><mo>(</mo><mi>V</mi><mo>&#x2212;</mo><mi>E</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">
I=\bar{g}s(V-E)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="mrel">=</span><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">g</span></span></span><span style="top:0em;margin-left:0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mord mathit">s</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mbin">&#x2212;</span><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="mclose">)</span></span></span></span></span></p>
<p>Here <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>E</mi></mrow><annotation encoding="application/x-tex">E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05764em;">E</span></span></span></span> is a reverse potential, which can determine whether the direction of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07847em;">I</span></span></span></span> is inhibition or excitation. For example, when the resting potential is about -65, subtracting a lower <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>E</mi></mrow><annotation encoding="application/x-tex">E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05764em;">E</span></span></span></span>, such as -75, will become positive, thus will change the direction of the current in the formula and produce the suppression current. The <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>E</mi></mrow><annotation encoding="application/x-tex">E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05764em;">E</span></span></span></span> value of excitatory synapses is relatively high, such as 0.</p>
<p>In terms of implementation, you can apply a synaptic delay to the variable <code>g</code>.</p>
<pre><code class="lang-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, pre, post, conn, g_max, E, **kwargs)</span>:</span>
    self.g_max = g_max
    self.E = E
    <span class="hljs-comment"># ...</span>
    self.s = bp.ops.zeros(self.size)
    self.g = self.register_constant_delay(<span class="hljs-string">&apos;g&apos;</span>, size=self.size, delay_time=delay)

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span><span class="hljs-params">(self, _t)</span>:</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> nb.prange(self.size):
        <span class="hljs-comment"># ...</span>
        self.g.push(i, self.g_max * self.s[i])
        self.post.input[post_id] -= self.g.pull(i) * (self.post.V[post_id] - self.E)
</code></pre>
<h3 id="212-electrical-synapses"><a name="212-electrical-synapses" class="anchor-navigation-ex-anchor" href="#212-electrical-synapses"><i class="fa fa-link" aria-hidden="true"></i></a>2.1.2 Electrical Synapses</h3>
<p>In addition to the chemical synapses described earlier, electrical synapses are also common in our neural system.</p>
<p><img src="../../figs/bio_gap.png"></p>
<p>As shown in the figure above, two neurons are connected by junction channels and can conduct electricity directly. Therefore, it can be seen that two neurons are connected by a constant resistance, as shown in the figure below.</p>
<p><img src="../../figs/gap_model.jpg"></p>
<p>According to Ohm&apos;s law, we can get the following equation,</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>I</mi><mrow><mn>1</mn></mrow></msub><mo>=</mo><mi>w</mi><mo>(</mo><msub><mi>V</mi><mrow><mn>0</mn></mrow></msub><mo>&#x2212;</mo><msub><mi>V</mi><mrow><mn>1</mn></mrow></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">
I_{1} = w (V_{0} - V_{1})
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.22222em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.22222em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>Here the conductance is expressed as <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span></span>, which represents the weight of the connection.</p>
<p>While implementing with BrainPy, you only need to specify the equation in the <code>update</code> function.</p>
<pre><code class="lang-python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Gap_junction</span><span class="hljs-params">(bp.TwoEndConn)</span>:</span>
    target_backend = <span class="hljs-string">&apos;general&apos;</span>

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, pre, post, conn, delay=<span class="hljs-number">0.</span>, k_spikelet=<span class="hljs-number">0.1</span>, post_refractory=False,  **kwargs)</span>:</span>
        self.delay = delay
        self.k_spikelet = k_spikelet
        self.post_refractory = post_refractory

        <span class="hljs-comment"># connections</span>
        self.conn = conn(pre.size, post.size)
        self.conn_mat = conn.requires(<span class="hljs-string">&apos;conn_mat&apos;</span>)
        self.size = bp.ops.shape(self.conn_mat)

        <span class="hljs-comment"># variables</span>
        self.w = bp.ops.ones(self.size)
        self.spikelet = self.register_constant_delay(<span class="hljs-string">&apos;spikelet&apos;</span>, size=self.size, delay_time=delay)

        super(Gap_junction, self).__init__(pre=pre, post=post, **kwargs)

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span><span class="hljs-params">(self, _t)</span>:</span>
        v_post = bp.ops.vstack((self.post.V,) * self.size[<span class="hljs-number">0</span>])
        v_pre = bp.ops.vstack((self.pre.V,) * self.size[<span class="hljs-number">1</span>]).T

        I_syn = self.w * (v_pre - v_post) * self.conn_mat
        self.post.input += bp.ops.sum(I_syn, axis=<span class="hljs-number">0</span>)

        self.spikelet.push(self.w * self.k_spikelet * bp.ops.unsqueeze(self.pre.spike, <span class="hljs-number">1</span>) * self.conn_mat)

        <span class="hljs-keyword">if</span> self.post_refractory:
            self.post.V += bp.ops.sum(self.spikelet.pull(), axis=<span class="hljs-number">0</span>) * (<span class="hljs-number">1.</span> - self.post.refractory)
        <span class="hljs-keyword">else</span>:
            self.post.V += bp.ops.sum(self.spikelet.pull(), axis=<span class="hljs-number">0</span>)
</code></pre>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

neu0 = bm.neurons.LIF(<span class="hljs-number">2</span>, monitors=[<span class="hljs-string">&apos;V&apos;</span>], t_refractory=<span class="hljs-number">0</span>)
neu0.V = np.ones(neu0.V.shape) * <span class="hljs-number">-10.</span>
neu1 = bm.neurons.LIF(<span class="hljs-number">3</span>, monitors=[<span class="hljs-string">&apos;V&apos;</span>], t_refractory=<span class="hljs-number">0</span>)
neu1.V = np.ones(neu1.V.shape) * <span class="hljs-number">-10.</span>
syn = Gap_junction(pre=neu0, post=neu1, conn=bp.connect.All2All(),
                    k_spikelet=<span class="hljs-number">5.</span>)
syn.w = np.ones(syn.w.shape) * <span class="hljs-number">.5</span>

net = bp.Network(neu0, neu1, syn)
net.run(<span class="hljs-number">100.</span>, inputs=(neu0, <span class="hljs-string">&apos;input&apos;</span>, <span class="hljs-number">30.</span>))

fig, gs = bp.visualize.get_figure(row_num=<span class="hljs-number">2</span>, col_num=<span class="hljs-number">1</span>, )

fig.add_subplot(gs[<span class="hljs-number">1</span>, <span class="hljs-number">0</span>])
plt.plot(net.ts, neu0.mon.V[:, <span class="hljs-number">0</span>], label=<span class="hljs-string">&apos;V0&apos;</span>)
plt.legend()

fig.add_subplot(gs[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>])
plt.plot(net.ts, neu1.mon.V[:, <span class="hljs-number">0</span>], label=<span class="hljs-string">&apos;V1&apos;</span>)
plt.legend()
plt.show()
</code></pre>
<p><img src="../../figs/out/output_37_0.png" alt="png"></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../synapses.html" class="navigation navigation-prev " aria-label="Previous page: 2. Synapse models">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="plasticity.html" class="navigation navigation-next " aria-label="Next page: 2.2 Synaptic plasticity">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"2.1 Synaptic dynamics","level":"1.3.1","depth":2,"next":{"title":"2.2 Synaptic plasticity","level":"1.3.2","depth":2,"path":"synapse/plasticity.md","ref":"synapse/plasticity.md","articles":[]},"previous":{"title":"2. Synapse models","level":"1.3","depth":1,"path":"synapses.md","ref":"synapses.md","articles":[{"title":"2.1 Synaptic dynamics","level":"1.3.1","depth":2,"path":"synapse/dynamics.md","ref":"synapse/dynamics.md","articles":[]},{"title":"2.2 Synaptic plasticity","level":"1.3.2","depth":2,"path":"synapse/plasticity.md","ref":"synapse/plasticity.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["-sharing","katex","code","anchor-navigation-ex","splitter"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"livereload":{},"splitter":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"code":{"copyButtons":true},"katex":{},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"anchor-navigation-ex":{"associatedWithSummary":true,"float":{"floatIcon":"fa fa-navicon","level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"mode":"float","multipleH1":true,"pageTop":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"printLog":false,"showGoTop":true,"showLevel":false},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"language":"en","gitbook":"*"},"file":{"path":"synapse/dynamics.md","mtime":"2021-04-20T08:19:23.042Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-04-20T09:39:15.617Z"},"basePath":"..","book":{"language":"en"}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-code/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

