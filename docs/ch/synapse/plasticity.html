
<!DOCTYPE HTML>
<html lang="ch" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>突触可塑性 Synaptic Plasticity · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-katex/katex.min.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-code/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    
    <link rel="prev" href="dynamics.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    神经元模型 Neuron models
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    突触模型 Synapse models
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="dynamics.html">
            
                <a href="dynamics.html">
            
                    
                    突触动力学 Synaptic Dynamics
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.3.2" data-path="plasticity.html">
            
                <a href="plasticity.html">
            
                    
                    突触可塑性 Synaptic Plasticity
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    网络模型 Network models
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../networks/rate_models.html">
            
                <a href="../networks/rate_models.html">
            
                    
                    发放率网络 Firing rate networks
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >突触可塑性 Synaptic Plasticity</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="&#x7A81;&#x89E6;&#x53EF;&#x5851;&#x6027;">&#x7A81;&#x89E6;&#x53EF;&#x5851;&#x6027;</h2>
<p>&#x6211;&#x4EEC;&#x521A;&#x521A;&#x8BA8;&#x8BBA;&#x4E86;&#x7A81;&#x89E6;&#x52A8;&#x529B;&#x5B66;&#xFF0C;&#x4F46;&#x8FD8;&#x6CA1;&#x6709;&#x6D89;&#x53CA;&#x5230;&#x7A81;&#x89E6;&#x53EF;&#x5851;&#x6027;&#x3002;&#x63A5;&#x4E0B;&#x6765;&#x5C31;&#x6765;&#x770B;&#x770B;&#x5982;&#x4F55;&#x4F7F;&#x7528;BrainPy&#x5B9E;&#x73B0;&#x7A81;&#x89E6;&#x53EF;&#x5851;&#x6027;&#x3002;</p>
<p>&#x53EF;&#x5851;&#x6027;&#x4E3B;&#x8981;&#x533A;&#x5206;&#x77ED;&#x65F6;&#x7A0B;&#x53EF;&#x5851;&#x6027;&#x4E0E;&#x957F;&#x65F6;&#x7A0B;&#x53EF;&#x5851;&#x6027;&#x3002;&#x6211;&#x4EEC;&#x5C06;&#x9996;&#x5148;&#x4ECB;&#x7ECD;&#x7A81;&#x89E6;&#x77ED;&#x65F6;&#x7A0B;&#x53EF;&#x5851;&#x6027;&#xFF08;STP&#xFF09;&#xFF0C;&#x7136;&#x540E;&#x4ECB;&#x7ECD;&#x51E0;&#x79CD;&#x4E0D;&#x540C;&#x7684;&#x7A81;&#x89E6;&#x957F;&#x65F6;&#x7A0B;&#x53EF;&#x5851;&#x6027;&#x6A21;&#x578B;&#x3002;</p>
<h3 id="&#x7A81;&#x89E6;&#x77ED;&#x65F6;&#x7A0B;&#x53EF;&#x5851;&#x6027;&#xFF08;stp&#xFF09;">&#x7A81;&#x89E6;&#x77ED;&#x65F6;&#x7A0B;&#x53EF;&#x5851;&#x6027;&#xFF08;STP&#xFF09;</h3>
<p>&#x6211;&#x4EEC;&#x9996;&#x5148;&#x770B;&#x5B9E;&#x9A8C;&#x7684;&#x7ED3;&#x679C;&#xFF0C;&#x56FE;&#x4E3A;&#x7A81;&#x89E6;&#x524D;&#x795E;&#x7ECF;&#x5143;&#x53D1;&#x653E;&#x65F6;&#x7A81;&#x89E6;&#x540E;&#x795E;&#x7ECF;&#x5143;&#x819C;&#x7535;&#x4F4D;&#x7684;&#x53D8;&#x5316;&#x3002;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x5F53;&#x7A81;&#x89E6;&#x524D;&#x795E;&#x7ECF;&#x5143;&#x4EE5;&#x77ED;&#x65F6;&#x95F4;&#x95F4;&#x9694;&#x6301;&#x7EED;&#x53D1;&#x653E;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x7A81;&#x89E6;&#x540E;&#x795E;&#x7ECF;&#x5143;&#x7684;&#x53CD;&#x5E94;&#x4F1A;&#x8D8A;&#x6765;&#x8D8A;&#x5F31;&#xFF0C;&#x5448;&#x73B0;&#x51FA;&#x77ED;&#x65F6;&#x7A0B;&#x6291;&#x5236; (short term depression)&#x3002;&#x4F46;&#x662F;&#x5F88;&#x5FEB;&#x5C31;&#x6062;&#x590D;&#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x4E2A;&#x53EF;&#x5851;&#x6027;&#x662F;&#x77ED;&#x671F;&#x7684;&#x3002;</p>
<p><img src="../../figs/stp.png"></p>
<p>&#x6A21;&#x578B;&#x7684;&#x516C;&#x5F0F;&#x5982;&#x4E0B;&#x3002;&#x5728;&#x8FD9;&#x91CC;&#xFF0C;&#x77ED;&#x65F6;&#x7A0B;&#x53EF;&#x5851;&#x6027;&#x4E3B;&#x8981;&#x7531;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">u</span></span></span></span>&#x548C;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span></span></span></span>&#x4E24;&#x4E2A;&#x53D8;&#x91CF;&#x6765;&#x63CF;&#x8FF0;&#x3002;&#x5176;&#x4E2D;&#xFF0C;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">u</span></span></span></span>&#x8868;&#x793A;&#x795E;&#x7ECF;&#x9012;&#x8D28;&#x91CA;&#x653E;&#x7684;&#x6982;&#x7387;&#xFF0C;&#x521D;&#x59CB;&#x503C;&#x4E3A;0&#xFF0C;&#x5E76;&#x968F;&#x7740;&#x7A81;&#x89E6;&#x524D;&#x795E;&#x7ECF;&#x5143;&#x7684;&#x6BCF;&#x6B21;&#x53D1;&#x653E;&#x800C;&#x589E;&#x52A0;&#xFF0C;&#x8D21;&#x732E;&#x77ED;&#x65F6;&#x7A0B;&#x6613;&#x5316;&#xFF08;STF&#xFF09;&#xFF1B;&#x800C;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span></span></span></span>&#x4EE3;&#x8868;&#x795E;&#x7ECF;&#x9012;&#x8D28;&#x7684;&#x5269;&#x4F59;&#x91CF;&#xFF0C;&#x521D;&#x59CB;&#x503C;&#x4E3A;1&#xFF0C;&#x6BCF;&#x6B21;&#x7A81;&#x89E6;&#x524D;&#x795E;&#x7ECF;&#x5143;&#x53D1;&#x653E;&#x90FD;&#x4F1A;&#x7528;&#x6389;&#x4E00;&#x4E9B;&#xFF0C;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x5B83;&#x4F1A;&#x51CF;&#x5C11;&#xFF0C;&#x4ECE;&#x800C;&#x8D21;&#x732E;&#x77ED;&#x65F6;&#x7A0B;&#x6291;&#x5236;&#xFF08;STD&#xFF09;&#x3002;&#x56E0;&#x6B64;&#x6613;&#x5316;&#x548C;&#x6291;&#x5236;&#x4E24;&#x4E2A;&#x65B9;&#x5411;&#x662F;&#x540C;&#x65F6;&#x53D1;&#x751F;&#x7684;&#x3002;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>&#x3C4;</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">\tau_f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.1132em;">&#x3C4;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.1132em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#x548C;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>&#x3C4;</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">\tau_d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.1132em;">&#x3C4;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.1132em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">d</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#x5206;&#x522B;&#x63A7;&#x5236;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">u</span></span></span></span>&#x548C;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span></span></span></span>&#x7684;&#x6062;&#x590D;&#x901F;&#x5EA6;&#xFF0C;&#x4E24;&#x8005;&#x5173;&#x7CFB;&#x51B3;&#x5B9A;&#x4E86;&#x53EF;&#x5851;&#x6027;&#x7684;&#x54EA;&#x4E2A;&#x65B9;&#x5411;&#x8D77;&#x4E3B;&#x5BFC;&#x4F5C;&#x7528;&#x3002;</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi>d</mi><mi>I</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mo>&#x2212;</mo><mfrac><mi>I</mi><mrow><mi>&#x3C4;</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">
\frac {dI} {dt} = - \frac I {\tau}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">d</span><span class="mord mathit">t</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">d</span><span class="mord mathit" style="margin-right:0.07847em;">I</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mrel">=</span><span class="mord">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit" style="margin-right:0.1132em;">&#x3C4;</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.07847em;">I</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi>d</mi><mi>u</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mo>&#x2212;</mo><mfrac><mi>u</mi><mrow><msub><mi>&#x3C4;</mi><mi>f</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">
\frac {du} {dt} = - \frac u {\tau_f} 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.343548em;vertical-align:-0.972108em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">d</span><span class="mord mathit">t</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">d</span><span class="mord mathit">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mrel">=</span><span class="mord">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.6859999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.1132em;">&#x3C4;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.1132em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord mathit">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi>d</mi><mi>x</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mn>1</mn><mo>&#x2212;</mo><mi>x</mi></mrow><mrow><msub><mi>&#x3C4;</mi><mi>d</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">
\frac {dx} {dt} =  \frac {1-x} {\tau_d} 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.20744em;vertical-align:-0.8360000000000001em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">d</span><span class="mord mathit">t</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">d</span><span class="mord mathit">x</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.1132em;">&#x3C4;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.1132em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">d</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">1</span><span class="mbin">&#x2212;</span><span class="mord mathit">x</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mtext>&#xA0;</mtext><mi mathvariant="normal">(</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mtext>&#xA0;</mtext><mtext>&#xA0;</mtext><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">)</mi><mi mathvariant="normal">,</mi><mtext>&#xA0;</mtext><mi mathvariant="normal">t</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi></mtext><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><msup><mi>u</mi><mo>+</mo></msup><mo>=</mo><msup><mi>u</mi><mo>&#x2212;</mo></msup><mo>+</mo><mi>U</mi><mo>(</mo><mn>1</mn><mo>&#x2212;</mo><msup><mi>u</mi><mo>&#x2212;</mo></msup><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msup><mi>I</mi><mo>+</mo></msup><mo>=</mo><msup><mi>I</mi><mo>&#x2212;</mo></msup><mo>+</mo><mi>A</mi><msup><mi>u</mi><mo>+</mo></msup><msup><mi>x</mi><mo>&#x2212;</mo></msup></mrow></mtd></mtr><mtr><mtd><mrow><msup><mi>x</mi><mo>+</mo></msup><mo>=</mo><msup><mi>x</mi><mo>&#x2212;</mo></msup><mo>&#x2212;</mo><msup><mi>u</mi><mo>+</mo></msup><msup><mi>x</mi><mo>&#x2212;</mo></msup></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\text{if (pre \ fire), then}
\begin{cases} 
u^+ = u^- + U(1-u^-) \\ 
I^+ = I^- + Au^+x^- \\
x^+ = x^- - u^+x^- 
\end{cases}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.41em;"></span><span class="strut bottom" style="height:4.32em;vertical-align:-1.9099999999999997em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord text displaystyle textstyle uncramped"><span class="mord mathrm">if&#xA0;(pre&#xA0;&#xA0;fire),&#xA0;then</span></span><span class="minner displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:0.9500099999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23A9;</span></span></span><span style="top:0.9500099999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23AA;</span></span></span><span style="top:-0.000010000000000287557em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23A8;</span></span></span><span style="top:-1.1500100000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23AA;</span></span></span><span style="top:-1.4500200000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23A7;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist"><span style="top:-1.4020000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">u</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">+</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">u</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2212;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord mathit">u</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2212;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span><span style="top:0.0379999999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">+</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2212;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord mathit">A</span><span class="mord"><span class="mord mathit">u</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">+</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2212;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:1.4779999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">+</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2212;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord mathit">u</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">+</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2212;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></p>
<p>&#x7528;BrainPy&#x5B9E;&#x73B0;&#x7684;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code class="lang-python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">STP</span><span class="hljs-params">(bp.TwoEndConn)</span>:</span>
    target_backend = <span class="hljs-string">&apos;general&apos;</span>

<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">derivative</span><span class="hljs-params">(s, u, x, t, tau, tau_d, tau_f)</span>:</span>
        dsdt = -s / tau
        dudt = - u / tau_f
        dxdt = (<span class="hljs-number">1</span> - x) / tau_d
        <span class="hljs-keyword">return</span> dsdt, dudt, dxdt

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, pre, post, conn, delay=<span class="hljs-number">0.</span>, U=<span class="hljs-number">0.15</span>, tau_f=<span class="hljs-number">1500.</span>, tau_d=<span class="hljs-number">200.</span>, tau=<span class="hljs-number">8.</span>,  **kwargs)</span>:</span>
        <span class="hljs-comment"># parameters</span>
        self.tau_d = tau_d
        self.tau_f = tau_f
        self.tau = tau
        self.U = U
        self.delay = delay

        <span class="hljs-comment"># connections</span>
        self.conn = conn(pre.size, post.size)
        self.conn_mat = conn.requires(<span class="hljs-string">&apos;conn_mat&apos;</span>)
        self.size = bp.ops.shape(self.conn_mat)

        <span class="hljs-comment"># variables</span>
        self.s = bp.ops.zeros(self.size)
        self.x = bp.ops.ones(self.size)
        self.u = bp.ops.zeros(self.size)
        self.w = bp.ops.ones(self.size)
        self.I_syn = self.register_constant_delay(<span class="hljs-string">&apos;I_syn&apos;</span>, size=self.size, delay_time=delay)

        self.integral = bp.odeint(f=self.derivative, method=<span class="hljs-string">&apos;exponential_euler&apos;</span>)

        super(STP, self).__init__(pre=pre, post=post, **kwargs)


    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span><span class="hljs-params">(self, _t)</span>:</span>
        self.s, u, x = self.integral(self.s, self.u, self.x, _t, self.tau, self.tau_d, self.tau_f)

        pre_spike_map = bp.ops.unsqueeze(self.pre.spike, <span class="hljs-number">1</span>) * self.conn_mat
        u += self.U * (<span class="hljs-number">1</span>-self.u) * pre_spike_map
        self.s += self.w * u * self.x * pre_spike_map
        x -= u * self.x * pre_spike_map

        self.u = u
        self.x = x

        self.I_syn.push(self.s)
        self.post.input += bp.ops.sum(self.I_syn.pull(), axis=<span class="hljs-number">0</span>)
</code></pre>
<pre><code class="lang-python">neu1 = bm.neurons.LIF(<span class="hljs-number">1</span>, monitors=[<span class="hljs-string">&apos;V&apos;</span>])
neu2 = bm.neurons.LIF(<span class="hljs-number">1</span>, monitors=[<span class="hljs-string">&apos;V&apos;</span>])

<span class="hljs-comment"># STD</span>
syn = STP(U=<span class="hljs-number">0.2</span>, tau_d=<span class="hljs-number">150.</span>, tau_f=<span class="hljs-number">2.</span>, pre=neu1, post=neu2, 
          conn=bp.connect.All2All(), monitors=[<span class="hljs-string">&apos;s&apos;</span>, <span class="hljs-string">&apos;u&apos;</span>, <span class="hljs-string">&apos;x&apos;</span>])
net = bp.Network(neu1, syn, neu2)
net.run(<span class="hljs-number">100.</span>, inputs=(neu1, <span class="hljs-string">&apos;input&apos;</span>, <span class="hljs-number">28.</span>))

<span class="hljs-comment"># plot</span>
fig, gs = bp.visualize.get_figure(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">7</span>)

fig.add_subplot(gs[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>])
plt.plot(net.ts, syn.mon.u[:, <span class="hljs-number">0</span>], label=<span class="hljs-string">&apos;u&apos;</span>)
plt.plot(net.ts, syn.mon.x[:, <span class="hljs-number">0</span>], label=<span class="hljs-string">&apos;x&apos;</span>)
plt.legend()

fig.add_subplot(gs[<span class="hljs-number">1</span>, <span class="hljs-number">0</span>])
plt.plot(net.ts, syn.mon.s[:, <span class="hljs-number">0</span>], label=<span class="hljs-string">&apos;s&apos;</span>)
plt.legend()

plt.xlabel(<span class="hljs-string">&apos;Time (ms)&apos;</span>)
plt.show()
</code></pre>
<p><img src="../../figs/out/output_43_0.png" alt="png"></p>
<pre><code class="lang-python">neu1 = bm.neurons.LIF(<span class="hljs-number">1</span>, monitors=[<span class="hljs-string">&apos;V&apos;</span>])
neu2 = bm.neurons.LIF(<span class="hljs-number">1</span>, monitors=[<span class="hljs-string">&apos;V&apos;</span>])

<span class="hljs-comment"># STF</span>
syn = STP(U=<span class="hljs-number">0.1</span>, tau_d=<span class="hljs-number">10</span>, tau_f=<span class="hljs-number">100.</span>, pre=neu1, post=neu2, 
          conn=bp.connect.All2All(), monitors=[<span class="hljs-string">&apos;s&apos;</span>, <span class="hljs-string">&apos;u&apos;</span>, <span class="hljs-string">&apos;x&apos;</span>])
net = bp.Network(neu1, syn, neu2)
net.run(<span class="hljs-number">100.</span>, inputs=(neu1, <span class="hljs-string">&apos;input&apos;</span>, <span class="hljs-number">28.</span>))

<span class="hljs-comment"># plot</span>
fig, gs = bp.visualize.get_figure(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">7</span>)

fig.add_subplot(gs[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>])
plt.plot(net.ts, syn.mon.u[:, <span class="hljs-number">0</span>], label=<span class="hljs-string">&apos;u&apos;</span>)
plt.plot(net.ts, syn.mon.x[:, <span class="hljs-number">0</span>], label=<span class="hljs-string">&apos;x&apos;</span>)
plt.legend()

fig.add_subplot(gs[<span class="hljs-number">1</span>, <span class="hljs-number">0</span>])
plt.plot(net.ts, syn.mon.s[:, <span class="hljs-number">0</span>], label=<span class="hljs-string">&apos;s&apos;</span>)
plt.legend()

plt.xlabel(<span class="hljs-string">&apos;Time (ms)&apos;</span>)
plt.show()
</code></pre>
<p><img src="../../figs/out/output_44_0.png" alt="png"></p>
<p>&#x8FD9;&#x4E9B;&#x56FE;&#x663E;&#x793A;&#xFF0C;&#x5F53;&#x6211;&#x4EEC;&#x8BBE;&#x7F6E;&#x53C2;&#x6570;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>&#x3C4;</mi><mi>d</mi></msub><mo>&gt;</mo><msub><mi>&#x3C4;</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">\tau_d&gt;\tau_f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.5391em;"></span><span class="strut bottom" style="height:0.8252079999999999em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.1132em;">&#x3C4;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.1132em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">d</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&gt;</span><span class="mord"><span class="mord mathit" style="margin-right:0.1132em;">&#x3C4;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.1132em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#x3001;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span></span></span></span>&#x6BCF;&#x7528;&#x6389;&#x4E00;&#x4E9B;&#x540E;&#x6062;&#x590D;&#x975E;&#x5E38;&#x7F13;&#x6162;&#xFF0C;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">u</span></span></span></span>&#x6BCF;&#x6B21;&#x4E0A;&#x5347;&#x540E;&#x975E;&#x5E38;&#x5FEB;&#x8870;&#x51CF;&#xFF0C;&#x56E0;&#x6B64;&#xFF0C;transmitter&#x4E0D;&#x591F;&#x7528;&#x4E86;&#xFF0C;&#x4E0D;&#x8DB3;&#x4EE5;&#x6253;&#x5F00;&#x53D7;&#x4F53;&#xFF0C;&#x8868;&#x73B0;&#x51FA;STD&#x4E3A;&#x4E3B;&#xFF1B;
&#x76F8;&#x53CD;&#xFF0C;&#x5F53;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>&#x3C4;</mi><mi>f</mi></msub><mo>&gt;</mo><msub><mi>&#x3C4;</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">\tau_f &gt; \tau_d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.5391em;"></span><span class="strut bottom" style="height:0.8252079999999999em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.1132em;">&#x3C4;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.1132em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&gt;</span><span class="mord"><span class="mord mathit" style="margin-right:0.1132em;">&#x3C4;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.1132em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">d</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#xFF0C;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span></span></span></span>&#x6BCF;&#x6B21;&#x7528;&#x5230;&#x540E;&#x5F88;&#x5FEB;&#x53C8;&#x8865;&#x5145;&#x56DE;&#x53BB;&#x4E86;&#xFF0C;&#x603B;&#x662F;&#x6709;&#x8DB3;&#x591F;&#x7684;transmitter&#x53EF;&#x7528;&#x3002;&#x540C;&#x65F6;&#xFF0C;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">u</span></span></span></span>&#x7684;&#x8870;&#x51CF;&#x975E;&#x5E38;&#x7F13;&#x6162;&#xFF0C;&#x56E0;&#x6B64;&#x91CA;&#x653E;transmitter&#x7684;&#x6982;&#x7387;&#x8D8A;&#x6765;&#x8D8A;&#x9AD8;&#xFF0C;&#x8868;&#x73B0;&#x51FA;STF&#x4E3A;&#x4E3B;&#x3002;</p>
<h3 id="&#x7A81;&#x89E6;&#x957F;&#x65F6;&#x7A0B;&#x53EF;&#x5851;&#x6027;">&#x7A81;&#x89E6;&#x957F;&#x65F6;&#x7A0B;&#x53EF;&#x5851;&#x6027;</h3>
<h4 id="&#x8109;&#x51B2;&#x65F6;&#x95F4;&#x4F9D;&#x8D56;&#x53EF;&#x5851;&#x6027;&#xFF08;stdp&#xFF09;">&#x8109;&#x51B2;&#x65F6;&#x95F4;&#x4F9D;&#x8D56;&#x53EF;&#x5851;&#x6027;&#xFF08;STDP&#xFF09;</h4>
<p>&#x9996;&#x5148;&#x6211;&#x4EEC;&#x770B;&#x5B9E;&#x9A8C;&#x4E0A;&#x753B;&#x7684;&#x56FE;&#xFF0C;x&#x8F74;&#x662F;&#x7A81;&#x89E6;&#x524D;&#x795E;&#x7ECF;&#x5143;&#x548C;&#x7A81;&#x89E6;&#x540E;&#x795E;&#x7ECF;&#x5143;&#x53D1;&#x653E;&#x7684;&#x65F6;&#x95F4;&#x5DEE;&#xFF0C;&#x96F6;&#x7684;&#x5DE6;&#x4FA7;&#x4EE3;&#x8868;&#x7A81;&#x89E6;&#x524D;&#x795E;&#x7ECF;&#x5143;&#x7684;&#x53D1;&#x653E;&#x6BD4;&#x7A81;&#x89E6;&#x540E;&#x795E;&#x7ECF;&#x5143;&#x7684;&#x66F4;&#x65E9;&#xFF0C;&#x7531;&#x56FE;&#x7247;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#x8868;&#x73B0;&#x4E3A;&#x957F;&#x65F6;&#x7A0B;&#x589E;&#x5F3A; (long term potentiation; LTP&#xFF09;&#xFF1B;&#x800C;&#x96F6;&#x7684;&#x53F3;&#x4FA7;&#x4EE3;&#x8868;&#x7A81;&#x89E6;&#x540E;&#x795E;&#x7ECF;&#x5143;&#x6BD4;&#x7A81;&#x89E6;&#x524D;&#x795E;&#x7ECF;&#x5143;&#x66F4;&#x5148;&#x53D1;&#x653E;&#xFF0C;&#x5448;&#x73B0;&#x8868;&#x73B0;&#x4E3A;&#x957F;&#x65F6;&#x7A0B;&#x6291;&#x5236; (long term depression; LTD&#xFF09;&#x3002;</p>
<p><img src="../../figs/stdp.png"></p>
<p>&#x6A21;&#x578B;&#x516C;&#x5F0F;&#x5982;&#x4E0B;&#xFF0C;&#x5176;&#x4E2D;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mrow><mi>s</mi><mi>o</mi><mi>u</mi><mi>r</mi><mi>c</mi><mi>e</mi></mrow></msub></mrow><annotation encoding="application/x-tex">A_{source}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">o</span><span class="mord mathit mtight">u</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span><span class="mord mathit mtight">c</span><span class="mord mathit mtight">e</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#x548C;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mrow><mi>t</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>e</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">A_{target}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mord mathit mtight">a</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span><span class="mord mathit mtight">e</span><span class="mord mathit mtight">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#x4E24;&#x4E2A;&#x53D8;&#x91CF;&#x5206;&#x522B;&#x63A7;&#x5236;LTD&#x548C;LTP&#x3002;&#x5F53;&#x7A81;&#x89E6;&#x524D;&#x795E;&#x7ECF;&#x5143;&#x5148;&#x4E8E;&#x7A81;&#x89E6;&#x540E;&#x795E;&#x7ECF;&#x5143;&#x53D1;&#x653E;&#x65F6;&#xFF0C;&#x5728;&#x7A81;&#x89E6;&#x540E;&#x795E;&#x7ECF;&#x5143;&#x53D1;&#x653E;&#x4E4B;&#x524D;&#xFF0C;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">A_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#x4E00;&#x76F4;&#x4E3A;0&#xFF0C;&#x6240;&#x4EE5;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span></span>&#x6682;&#x65F6;&#x4E0D;&#x4F1A;&#x6709;&#x53D8;&#x5316;&#xFF0C;&#x53EA;&#x662F;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">A_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#x6301;&#x7EED;&#x589E;&#x52A0;&#xFF1B;&#x76F4;&#x5230;&#x7A81;&#x89E6;&#x540E;&#x795E;&#x7ECF;&#x5143;&#x53D1;&#x653E;&#x65F6;&#xFF0C;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span></span>&#x589E;&#x52A0;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mi>s</mi></msub><mo>&#x2212;</mo><msub><mi>A</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">A_s - A_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#xFF0C;&#x6240;&#x4EE5;&#x8868;&#x73B0;&#x4E3A;&#x957F;&#x65F6;&#x7A0B;&#x589E;&#x5F3A;&#xFF08;LTP&#xFF09;&#x3002;&#x53CD;&#x4E4B;&#x4EA6;&#x7136;&#x3002;</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi>d</mi><msub><mi>A</mi><mi>s</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mo>&#x2212;</mo><mfrac><mrow><msub><mi>A</mi><mi>s</mi></msub></mrow><mrow><msub><mi>&#x3C4;</mi><mi>s</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">
\frac {dA_s} {dt} = - \frac {A_s} {\tau_s} 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.20744em;vertical-align:-0.8360000000000001em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">d</span><span class="mord mathit">t</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">d</span><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mrel">=</span><span class="mord">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.1132em;">&#x3C4;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.1132em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi>d</mi><msub><mi>A</mi><mi>t</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mo>&#x2212;</mo><mfrac><mrow><msub><mi>A</mi><mi>t</mi></msub></mrow><mrow><msub><mi>&#x3C4;</mi><mi>t</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">
\frac {dA_t} {dt} = - \frac {A_t} {\tau_t} 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.20744em;vertical-align:-0.8360000000000001em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">d</span><span class="mord mathit">t</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">d</span><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mrel">=</span><span class="mord">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.1132em;">&#x3C4;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.1132em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mtext>&#xA0;</mtext><mi mathvariant="normal">(</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mtext>&#xA0;</mtext><mtext>&#xA0;</mtext><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">)</mi><mi mathvariant="normal">,</mi><mtext>&#xA0;</mtext><mi mathvariant="normal">t</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi></mtext><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><mi>s</mi><mo>&#x2190;</mo><mi>s</mi><mo>+</mo><mi>w</mi></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>A</mi><mi>s</mi></msub><mo>&#x2190;</mo><msub><mi>A</mi><mi>s</mi></msub><mo>+</mo><mi mathvariant="normal">&#x394;</mi><msub><mi>A</mi><mi>s</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><mi>w</mi><mo>&#x2190;</mo><mi>w</mi><mo>&#x2212;</mo><msub><mi>A</mi><mi>t</mi></msub></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\text{if (pre \ fire), then}
\begin{cases} 
s \leftarrow s + w \\
A_s \leftarrow A_s + \Delta A_s \\ 
w \leftarrow w - A_t 
\end{cases}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.41em;"></span><span class="strut bottom" style="height:4.32em;vertical-align:-1.9099999999999997em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord text displaystyle textstyle uncramped"><span class="mord mathrm">if&#xA0;(pre&#xA0;&#xA0;fire),&#xA0;then</span></span><span class="minner displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:0.9500099999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23A9;</span></span></span><span style="top:0.9500099999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23AA;</span></span></span><span style="top:-0.000010000000000287557em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23A8;</span></span></span><span style="top:-1.1500100000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23AA;</span></span></span><span style="top:-1.4500200000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23A7;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist"><span style="top:-1.4020000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit">s</span><span class="mrel">&#x2190;</span><span class="mord mathit">s</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span><span style="top:0.0379999999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&#x2190;</span><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord mathrm">&#x394;</span><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:1.4779999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mrel">&#x2190;</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mtext>&#xA0;</mtext><mi mathvariant="normal">(</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">t</mi><mtext>&#xA0;</mtext><mtext>&#xA0;</mtext><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">)</mi><mi mathvariant="normal">,</mi><mtext>&#xA0;</mtext><mi mathvariant="normal">t</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi></mtext><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><msub><mi>A</mi><mi>t</mi></msub><mo>&#x2190;</mo><msub><mi>A</mi><mi>t</mi></msub><mo>+</mo><mi mathvariant="normal">&#x394;</mi><msub><mi>A</mi><mi>t</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><mi>w</mi><mo>&#x2190;</mo><mi>w</mi><mo>+</mo><msub><mi>A</mi><mi>s</mi></msub></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\text{if (post \ fire), then}
\begin{cases} 
A_t \leftarrow A_t + \Delta A_t \\ 
w \leftarrow w + A_s 
\end{cases}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.75em;"></span><span class="strut bottom" style="height:3.0000299999999998em;vertical-align:-1.25003em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord text displaystyle textstyle uncramped"><span class="mord mathrm">if&#xA0;(post&#xA0;&#xA0;fire),&#xA0;then</span></span><span class="minner displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist"><span style="top:-0.6819999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&#x2190;</span><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord mathrm">&#x394;</span><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.7579999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mrel">&#x2190;</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mbin">+</span><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></p>
<p>&#x73B0;&#x5728;&#x8BA9;&#x6211;&#x4EEC;&#x770B;&#x770B;&#x5982;&#x4F55;&#x4F7F;&#x7528;BrainPy&#x6765;&#x5B9E;&#x73B0;&#x8FD9;&#x4E2A;&#x6A21;&#x578B;&#x3002;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">s</span></span></span></span>&#x4F1A;&#x5728;&#x7A81;&#x89E6;&#x524D;&#x795E;&#x7ECF;&#x5143;&#x51FA;&#x73B0;&#x8109;&#x51B2;&#x65F6;&#x589E;&#x52A0;&#xFF0C;&#x8FD9;&#x4E0E;&#x524D;&#x9762;&#x4ECB;&#x7ECD;&#x7684;&#x7A81;&#x89E6;&#x6A21;&#x578B;&#x7684;&#x52A8;&#x529B;&#x5B66;&#x4E00;&#x81F4;&#xFF0C;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x901A;&#x5E38;&#x4F7F;&#x7528;&#x5355;&#x6307;&#x6570;&#x8870;&#x51CF; (single exponential decay)&#x6A21;&#x578B;&#x6765;&#x5B9E;&#x73B0;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">s</span></span></span></span>&#x7684;&#x52A8;&#x529B;&#x5B66;&#x3002;</p>
<pre><code class="lang-python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">STDP</span><span class="hljs-params">(bp.TwoEndConn)</span>:</span>
    target_backend = <span class="hljs-string">&apos;general&apos;</span>

<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">derivative</span><span class="hljs-params">(s, A_s, A_t, t, tau, tau_s, tau_t)</span>:</span>
        dsdt = -s / tau
        dAsdt = - A_s / tau_s
        dAtdt = - A_t / tau_t
        <span class="hljs-keyword">return</span> dsdt, dAsdt, dAtdt

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, pre, post, conn, delay=<span class="hljs-number">0.</span>, 
                delta_A_s=<span class="hljs-number">0.5</span>, delta_A_t=<span class="hljs-number">0.5</span>, w_min=<span class="hljs-number">0.</span>, w_max=<span class="hljs-number">20.</span>, 
                tau_s=<span class="hljs-number">10.</span>, tau_t=<span class="hljs-number">10.</span>, tau=<span class="hljs-number">10.</span>, **kwargs)</span>:</span>
        <span class="hljs-comment"># parameters</span>
        self.tau_s = tau_s
        self.tau_t = tau_t
        self.tau = tau
        self.delta_A_s = delta_A_s
        self.delta_A_t = delta_A_t
        self.w_min = w_min
        self.w_max = w_max
        self.delay = delay

        <span class="hljs-comment"># connections</span>
        self.conn = conn(pre.size, post.size)
        self.conn_mat = conn.requires(<span class="hljs-string">&apos;conn_mat&apos;</span>)
        self.size = bp.ops.shape(self.conn_mat)

        <span class="hljs-comment"># variables</span>
        self.s = bp.ops.zeros(self.size)
        self.A_s = bp.ops.zeros(self.size)
        self.A_t = bp.ops.zeros(self.size)
        self.w = bp.ops.ones(self.size) * <span class="hljs-number">1.</span>
        self.I_syn = self.register_constant_delay(<span class="hljs-string">&apos;I_syn&apos;</span>, size=self.size, delay_time=delay)

        self.integral = bp.odeint(f=self.derivative, method=<span class="hljs-string">&apos;exponential_euler&apos;</span>)

        super(STDP, self).__init__(pre=pre, post=post, **kwargs)


    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span><span class="hljs-params">(self, _t)</span>:</span>
        s, A_s, A_t = self.integral(self.s, self.A_s, self.A_t, 
                                    _t, self.tau, self.tau_s, self.tau_t)
        w = self.w

        pre_spike_map = bp.ops.unsqueeze(self.pre.spike, <span class="hljs-number">1</span>) * self.conn_mat
        s += w * pre_spike_map
        A_s += self.delta_A_s * pre_spike_map
        w -= A_t * pre_spike_map

        post_spike_map = bp.ops.unsqueeze(self.post.spike, <span class="hljs-number">0</span>) * self.conn_mat
        A_t += self.delta_A_t * post_spike_map
        w += A_s * post_spike_map

        self.A_s = A_s
        self.A_t = A_t
        self.w = bp.ops.clip(w, self.w_min, self.w_max)
        self.s = s

        self.I_syn.push(self.s)
        self.post.input += bp.ops.sum(self.I_syn.pull(), axis=<span class="hljs-number">0</span>)
</code></pre>
<pre><code class="lang-python">pre = bm.neurons.LIF(<span class="hljs-number">1</span>, monitors=[<span class="hljs-string">&apos;spike&apos;</span>])
post = bm.neurons.LIF(<span class="hljs-number">1</span>, monitors=[<span class="hljs-string">&apos;spike&apos;</span>])

<span class="hljs-comment"># pre before post</span>
duration = <span class="hljs-number">60.</span>
(I_pre, _) = bp.inputs.constant_current([(<span class="hljs-number">0</span>, <span class="hljs-number">5</span>), (<span class="hljs-number">30</span>, <span class="hljs-number">15</span>), 
                                         (<span class="hljs-number">0</span>, <span class="hljs-number">5</span>), (<span class="hljs-number">30</span>, <span class="hljs-number">15</span>), 
                                         (<span class="hljs-number">0</span>, duration<span class="hljs-number">-40</span>)])
(I_post, _) = bp.inputs.constant_current([(<span class="hljs-number">0</span>, <span class="hljs-number">7</span>), (<span class="hljs-number">30</span>, <span class="hljs-number">15</span>), 
                                          (<span class="hljs-number">0</span>, <span class="hljs-number">5</span>), (<span class="hljs-number">30</span>, <span class="hljs-number">15</span>), 
                                          (<span class="hljs-number">0</span>, duration<span class="hljs-number">-7</span><span class="hljs-number">-35</span>)])

syn = STDP(pre=pre, post=post, conn=bp.connect.All2All(), monitors=[<span class="hljs-string">&apos;s&apos;</span>, <span class="hljs-string">&apos;A_s&apos;</span>, <span class="hljs-string">&apos;A_t&apos;</span>, <span class="hljs-string">&apos;w&apos;</span>])
net = bp.Network(pre, syn, post)
net.run(duration, inputs=[(pre, <span class="hljs-string">&apos;input&apos;</span>, I_pre), (post, <span class="hljs-string">&apos;input&apos;</span>, I_post)])

<span class="hljs-comment"># plot</span>
fig, gs = bp.visualize.get_figure(<span class="hljs-number">3</span>, <span class="hljs-number">1</span>)

fig.add_subplot(gs[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>])
plt.plot(net.ts, syn.mon.w[:, <span class="hljs-number">0</span>], label=<span class="hljs-string">&apos;w&apos;</span>)
plt.legend()

fig.add_subplot(gs[<span class="hljs-number">2</span>, <span class="hljs-number">0</span>])
plt.plot(net.ts, <span class="hljs-number">2</span>*pre.mon.spike[:, <span class="hljs-number">0</span>], label=<span class="hljs-string">&apos;pre_spike&apos;</span>)
plt.plot(net.ts, <span class="hljs-number">2</span>*post.mon.spike[:, <span class="hljs-number">0</span>], label=<span class="hljs-string">&apos;post_spike&apos;</span>)
plt.legend()

fig.add_subplot(gs[<span class="hljs-number">1</span>, <span class="hljs-number">0</span>])
plt.plot(net.ts, syn.mon.s[:, <span class="hljs-number">0</span>], label=<span class="hljs-string">&apos;s&apos;</span>)
plt.legend()

plt.xlabel(<span class="hljs-string">&apos;Time (ms)&apos;</span>)
plt.show()
</code></pre>
<p><img src="../../figs/out/output_51_0.png" alt="png"></p>
<p>&#x7ED3;&#x679C;&#x6B63;&#x5982;&#x6211;&#x4EEC;&#x6240;&#x9884;&#x671F;&#x7684;&#xFF0C;&#x5F53;&#x7A81;&#x89E6;&#x524D;&#x795E;&#x7ECF;&#x5143;&#x5728;&#x7A81;&#x89E6;&#x540E;&#x795E;&#x7ECF;&#x5143;&#x4E4B;&#x524D;&#x53D1;&#x653E;&#x65F6;&#xFF0C;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span></span>&#x589E;&#x52A0;&#xFF0C;&#x5448;&#x73B0;LTP&#x3002;</p>
<pre><code class="lang-python">pre = bm.neurons.LIF(<span class="hljs-number">1</span>, monitors=[<span class="hljs-string">&apos;spike&apos;</span>])
post = bm.neurons.LIF(<span class="hljs-number">1</span>, monitors=[<span class="hljs-string">&apos;spike&apos;</span>])

<span class="hljs-comment"># post before pre</span>
duration = <span class="hljs-number">60.</span>
(I_post, _) = bp.inputs.constant_current([(<span class="hljs-number">0</span>, <span class="hljs-number">5</span>), (<span class="hljs-number">30</span>, <span class="hljs-number">15</span>), 
                                         (<span class="hljs-number">0</span>, <span class="hljs-number">5</span>), (<span class="hljs-number">30</span>, <span class="hljs-number">15</span>), 
                                         (<span class="hljs-number">0</span>, duration<span class="hljs-number">-40</span>)])
(I_pre, _) = bp.inputs.constant_current([(<span class="hljs-number">0</span>, <span class="hljs-number">7</span>), (<span class="hljs-number">30</span>, <span class="hljs-number">15</span>), 
                                          (<span class="hljs-number">0</span>, <span class="hljs-number">5</span>), (<span class="hljs-number">30</span>, <span class="hljs-number">15</span>), 
                                          (<span class="hljs-number">0</span>, duration<span class="hljs-number">-7</span><span class="hljs-number">-35</span>)])

syn = STDP(pre=pre, post=post, conn=bp.connect.All2All(), monitors=[<span class="hljs-string">&apos;s&apos;</span>, <span class="hljs-string">&apos;A_s&apos;</span>, <span class="hljs-string">&apos;A_t&apos;</span>, <span class="hljs-string">&apos;w&apos;</span>])
net = bp.Network(pre, syn, post)
net.run(duration, inputs=[(pre, <span class="hljs-string">&apos;input&apos;</span>, I_pre), (post, <span class="hljs-string">&apos;input&apos;</span>, I_post)])

<span class="hljs-comment"># plot</span>
fig, gs = bp.visualize.get_figure(<span class="hljs-number">3</span>, <span class="hljs-number">1</span>)

fig.add_subplot(gs[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>])
plt.plot(net.ts, syn.mon.w[:, <span class="hljs-number">0</span>], label=<span class="hljs-string">&apos;w&apos;</span>)
plt.legend()

fig.add_subplot(gs[<span class="hljs-number">2</span>, <span class="hljs-number">0</span>])
plt.plot(net.ts, <span class="hljs-number">2</span>*pre.mon.spike[:, <span class="hljs-number">0</span>], label=<span class="hljs-string">&apos;pre_spike&apos;</span>)
plt.plot(net.ts, <span class="hljs-number">2</span>*post.mon.spike[:, <span class="hljs-number">0</span>], label=<span class="hljs-string">&apos;post_spike&apos;</span>)
plt.legend()

fig.add_subplot(gs[<span class="hljs-number">1</span>, <span class="hljs-number">0</span>])
plt.plot(net.ts, syn.mon.s[:, <span class="hljs-number">0</span>], label=<span class="hljs-string">&apos;s&apos;</span>)
plt.legend()

plt.xlabel(<span class="hljs-string">&apos;Time (ms)&apos;</span>)
plt.show()
</code></pre>
<p><img src="../../figs/out/output_53_0.png" alt="png"></p>
<p>&#x5982;&#x6211;&#x4EEC;&#x6240;&#x6599;&#xFF0C;&#x5F53;&#x7A81;&#x89E6;&#x540E;&#x795E;&#x7ECF;&#x5143;&#x5148;&#x4E8E;&#x7A81;&#x89E6;&#x524D;&#x795E;&#x7ECF;&#x5143;&#x53D1;&#x653E;&#x65F6;&#xFF0C;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span></span>&#x51CF;&#x5C11;&#xFF0C;&#x5448;&#x73B0;LTD&#x3002;</p>
<h4 id="oja&#x6CD5;&#x5219;">Oja&#x6CD5;&#x5219;</h4>
<p>&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x770B;&#x57FA;&#x4E8E;&#x8D6B;&#x5E03;&#x5B66;&#x4E60;&#x5F8B;&#xFF08;Hebbian learning&#xFF09;&#x7684;&#x53D1;&#x653E;&#x7387;&#x6A21;&#x578B; (rate model)&#x3002;</p>
<p>&#x8D6B;&#x5E03;&#x5B66;&#x4E60;&#x5F8B;&#x8BA4;&#x4E3A;&#x76F8;&#x4E92;&#x8FDE;&#x63A5;&#x7684;&#x4E24;&#x4E2A;&#x795E;&#x7ECF;&#x5143;&#x5728;&#x7ECF;&#x5386;&#x540C;&#x6B65;&#x7684;&#x653E;&#x7535;&#x6D3B;&#x52A8;&#x540E;&#xFF0C;&#x5B83;&#x4EEC;&#x4E4B;&#x95F4;&#x7684;&#x7A81;&#x89E6;&#x8FDE;&#x63A5;&#x5C31;&#x4F1A;&#x5F97;&#x5230;&#x589E;&#x5F3A;&#x3002;&#x800C;&#x8FD9;&#x4E2A;&#x540C;&#x6B65;&#x4E0D;&#x9700;&#x8981;&#x5728;&#x610F;&#x4E24;&#x4E2A;&#x795E;&#x7ECF;&#x5143;&#x524D;&#x540E;&#x53D1;&#x653E;&#x7684;&#x6B21;&#x5E8F;&#xFF0C;&#x56E0;&#x6B64;&#x53EF;&#x4EE5;&#x5FFD;&#x7565;&#x5177;&#x4F53;&#x7684;&#x53D1;&#x653E;&#x65F6;&#x95F4;&#xFF0C;&#x7B80;&#x5316;&#x4E3A;&#x53D1;&#x653E;&#x7387;&#x6A21;&#x578B;&#x3002;&#x6211;&#x4EEC;&#x9996;&#x5148;&#x770B;&#x8D6B;&#x5E03;&#x5B66;&#x4E60;&#x5F8B;&#x7684;&#x4E00;&#x822C;&#x5F62;&#x5F0F;&#xFF0C;&#x5BF9;&#x4E8E;&#x5982;&#x56FE;&#x6240;&#x793A;&#x7684;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span></span>&#x5230;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.65952em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span></span></span></span>&#x7684;&#x8FDE;&#x63A5;&#xFF0C;&#x7528;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>v</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">v_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#x548C;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">v_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#x5206;&#x522B;&#x8868;&#x793A;&#x524D;&#x795E;&#x7ECF;&#x5143;&#x7EC4;&#x548C;&#x540E;&#x795E;&#x7ECF;&#x5143;&#x7EC4;&#x7684;&#x53D1;&#x653E;&#x7387; (firing rate)&#xFF0C;&#x6839;&#x636E;&#x8D6B;&#x5E03;&#x5B66;&#x4E60;&#x5F8B;&#x7684;&#x5C40;&#x90E8;&#x6027;(locality)&#x7279;&#x6027;&#xFF0C;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">w_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#x7684;&#x53D8;&#x5316;&#x53D7;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span></span>&#x672C;&#x8EAB;&#x3001;&#x4EE5;&#x53CA;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>v</mi><mi>j</mi></msub><mo separator="true">,</mo><msub><mi>v</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">v_j, v_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#x7684;&#x5F71;&#x54CD;&#xFF0C;&#x53EF;&#x5F97;&#x4EE5;&#x4E0B;&#x5FAE;&#x5206;&#x65B9;&#x7A0B;&#x3002;</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mi>d</mi><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>F</mi><mo>(</mo><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo separator="true">;</mo><msub><mi>v</mi><mrow><mi>i</mi></mrow></msub><mo separator="true">,</mo><msub><mi>v</mi><mi>j</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">
\frac d {dt} w_{ij} = F(w_{ij}; v_{i},v_j)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">d</span><span class="mord mathit">t</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord mathit">d</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">;</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>&#x628A;&#x4E0A;&#x5F0F;&#x53F3;&#x8FB9;&#x7ECF;&#x8FC7;&#x6CF0;&#x52D2;&#x5C55;&#x5F00;&#x5F97;&#x5230;&#x4EE5;&#x4E0B;&#x5F0F;&#x5B50;&#x3002;</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mi>d</mi><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>c</mi><mrow><mn>0</mn><mn>0</mn></mrow></msub><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>c</mi><mrow><mn>1</mn><mn>0</mn></mrow></msub><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>v</mi><mi>j</mi></msub><mo>+</mo><msub><mi>c</mi><mrow><mn>0</mn><mn>1</mn></mrow></msub><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>v</mi><mi>i</mi></msub><mo>+</mo><msub><mi>c</mi><mrow><mn>2</mn><mn>0</mn></mrow></msub><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msubsup><mi>v</mi><mi>j</mi><mn>2</mn></msubsup><mo>+</mo><msub><mi>c</mi><mrow><mn>0</mn><mn>2</mn></mrow></msub><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msubsup><mi>v</mi><mi>i</mi><mn>2</mn></msubsup><mo>+</mo><msub><mi>c</mi><mrow><mn>1</mn><mn>1</mn></mrow></msub><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>v</mi><mi>i</mi></msub><msub><mi>v</mi><mi>j</mi></msub><mo>+</mo><mi>O</mi><mo>(</mo><msup><mi>v</mi><mn>3</mn></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">
\frac d {dt} w_{ij} = c_{00} w_{ij} + c_{10} w_{ij} v_j + c_{01} w_{ij} v_i + c_{20} w_{ij} v_j ^2 + c_{02} w_{ij} v_i ^2 + c_{11} w_{ij} v_i v_j + O(v^3)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">d</span><span class="mord mathit">t</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord mathit">d</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">c</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">0</span><span class="mord mathrm mtight">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit">c</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span><span class="mord mathrm mtight">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit">c</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">0</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit">c</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span><span class="mord mathrm mtight">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit">c</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">0</span><span class="mord mathrm mtight">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit">c</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">3</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>&#x7B2C;6&#x9879;&#x5305;&#x542B;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub><msub><mi>v</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">v_i v_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#xFF0C;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>c</mi><mrow><mn>1</mn><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">c_{11}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">c</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#x975E;0&#x624D;&#x6EE1;&#x8DB3;&#x8D6B;&#x5E03;&#x5B66;&#x4E60;&#x5F8B;&#x7684;&#x540C;&#x6B65;&#x53D1;&#x653E;&#x3002;&#x4F8B;&#x5982;<strong>Oja&#x6CD5;&#x5219;</strong>&#x7684;&#x516C;&#x5F0F;&#x5982;&#x4E0B;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#x5BF9;&#x5E94;&#x4E8E;&#x4E0A;&#x5F0F;&#x7B2C;5&#x3001;6&#x9879;&#x3002;</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mi>d</mi><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>&#x3B3;</mi><mo>[</mo><msub><mi>v</mi><mi>i</mi></msub><msub><mi>v</mi><mi>j</mi></msub><mo>&#x2212;</mo><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msubsup><mi>v</mi><mi>i</mi><mn>2</mn></msubsup><mo>]</mo></mrow><annotation encoding="application/x-tex">
\frac d {dt} w_{ij} = \gamma [v_i v_j - w_{ij} v_i ^2 ]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">d</span><span class="mord mathit">t</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord mathit">d</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.05556em;">&#x3B3;</span><span class="mopen">[</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">]</span></span></span></span></span></p>
<p>&#x4E0B;&#x9762;&#x6211;&#x4EEC;&#x7528;BrainPy&#x6765;&#x5B9E;&#x73B0;Oja&#x6CD5;&#x5219;&#x3002;</p>
<pre><code class="lang-python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Oja</span><span class="hljs-params">(bp.TwoEndConn)</span>:</span>
    target_backend = <span class="hljs-string">&apos;general&apos;</span>

<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">derivative</span><span class="hljs-params">(w, t, gamma, r_pre, r_post)</span>:</span>
        dwdt = gamma * (r_post * r_pre - r_post * r_post * w)
        <span class="hljs-keyword">return</span> dwdt

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, pre, post, conn, delay=<span class="hljs-number">0.</span>,
                 gamma=<span class="hljs-number">0.005</span>, w_max=<span class="hljs-number">1.</span>, w_min=<span class="hljs-number">0.</span>,
                 **kwargs)</span>:</span>
        <span class="hljs-comment"># params</span>
        self.gamma = gamma
        self.w_max = w_max
        self.w_min = w_min
        <span class="hljs-comment"># no delay in firing rate models</span>

        <span class="hljs-comment"># conns</span>
        self.conn = conn(pre.size, post.size)
        self.conn_mat = conn.requires(<span class="hljs-string">&apos;conn_mat&apos;</span>)
        self.size = bp.ops.shape(self.conn_mat)

        <span class="hljs-comment"># data</span>
        self.w = bp.ops.ones(self.size) * <span class="hljs-number">0.05</span>

        self.integral = bp.odeint(f=self.derivative)
        super(Oja, self).__init__(pre=pre, post=post, **kwargs)

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span><span class="hljs-params">(self, _t)</span>:</span>
        w = self.conn_mat * self.w
        self.post.r = bp.ops.sum(w.T * self.pre.r, axis=<span class="hljs-number">1</span>)

        <span class="hljs-comment"># resize to matrix</span>
        dim = self.size
        r_post = bp.ops.vstack((self.post.r,) * dim[<span class="hljs-number">0</span>])
        r_pre = bp.ops.vstack((self.pre.r,) * dim[<span class="hljs-number">1</span>]).T

        self.w = self.integral(w, _t, self.gamma, r_pre, r_post)
</code></pre>
<p>&#x6211;&#x4EEC;&#x6253;&#x7B97;&#x5B9E;&#x73B0;&#x5982;&#x56FE;&#x6240;&#x793A;&#x7684;&#x8FDE;&#x63A5;&#xFF0C;&#x7D2B;&#x8272;&#x540C;&#x65F6;&#x63A5;&#x53D7;&#x84DD;&#x8272;&#x548C;&#x7EA2;&#x8272;&#x4E24;&#x7FA4;&#x795E;&#x7ECF;&#x5143;&#x7684;&#x8F93;&#x5165;&#x3002;&#x7ED9;&#x540E;&#x795E;&#x7ECF;&#x5143;&#x7684;input&#x548C;&#x7EA2;&#x8272;&#x662F;&#x5B8C;&#x5168;&#x4E00;&#x81F4;&#x7684;&#xFF0C;&#x800C;&#x84DD;&#x8272;&#x4E00;&#x5F00;&#x59CB;&#x4E00;&#x81F4;&#xFF0C;&#x540E;&#x6765;&#x4E0D;&#x4E00;&#x81F4;&#x4E86;&#x3002;</p>
<p><img src="../../figs/conn.png"></p>
<p>&#x7531;&#x4E8E;Oja&#x662F;&#x4E00;&#x4E2A;&#x53D1;&#x653E;&#x7387;&#x6A21;&#x578B;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x57FA;&#x4E8E;&#x53D1;&#x653E;&#x7387;&#x7684;&#x795E;&#x7ECF;&#x5143;&#x6A21;&#x578B;&#x6765;&#x89C2;&#x5BDF;&#x4E24;&#x7EC4;&#x795E;&#x7ECF;&#x5143;&#x7684;&#x5B66;&#x4E60;&#x89C4;&#x5219;&#x3002;</p>
<pre><code class="lang-python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">neu</span><span class="hljs-params">(bp.NeuGroup)</span>:</span>
    target_backend = <span class="hljs-string">&apos;general&apos;</span>

<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">integral</span><span class="hljs-params">(r, t, I, tau)</span>:</span>
        dr = -r / tau + I
        <span class="hljs-keyword">return</span> dr

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, size, tau=<span class="hljs-number">10.</span>, **kwargs)</span>:</span>
        self.tau = tau

        self.r = bp.ops.zeros(size)
        self.input = bp.ops.zeros(size)

        self.g = bp.odeint(self.integral)

        super(neu, self).__init__(size=size, **kwargs)

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span><span class="hljs-params">(self, _t)</span>:</span>
        self.r = self.g(self.r, _t, self.input, self.tau)
        self.input[:] = <span class="hljs-number">0</span>
</code></pre>
<pre><code class="lang-python"><span class="hljs-comment"># set params</span>
neu_pre_num = <span class="hljs-number">2</span>
neu_post_num = <span class="hljs-number">2</span>
dt = <span class="hljs-number">0.02</span>
bp.backend.set(<span class="hljs-string">&apos;numpy&apos;</span>, dt=dt)

<span class="hljs-comment"># build network</span>
neu_pre = neu(neu_pre_num, monitors=[<span class="hljs-string">&apos;r&apos;</span>])
neu_post = neu(neu_post_num, monitors=[<span class="hljs-string">&apos;r&apos;</span>])

syn = Oja(pre=neu_pre, post=neu_post,
          conn=bp.connect.All2All(), monitors=[<span class="hljs-string">&apos;w&apos;</span>])

net = bp.Network(neu_pre, syn, neu_post)

<span class="hljs-comment"># create input</span>
current_mat_in = []
current_mat_out = []
current1, _ = bp.inputs.constant_current(
    [(<span class="hljs-number">2.</span>, <span class="hljs-number">20.</span>), (<span class="hljs-number">0.</span>, <span class="hljs-number">20.</span>)] * <span class="hljs-number">3</span> + [(<span class="hljs-number">0.</span>, <span class="hljs-number">20.</span>), (<span class="hljs-number">0.</span>, <span class="hljs-number">20.</span>)] * <span class="hljs-number">2</span>)
current2, _ = bp.inputs.constant_current([(<span class="hljs-number">2.</span>, <span class="hljs-number">20.</span>), (<span class="hljs-number">0.</span>, <span class="hljs-number">20.</span>)] * <span class="hljs-number">5</span>)
current3, _ = bp.inputs.constant_current([(<span class="hljs-number">2.</span>, <span class="hljs-number">20.</span>), (<span class="hljs-number">0.</span>, <span class="hljs-number">20.</span>)] * <span class="hljs-number">5</span>)
current_mat_in = np.vstack((current1, current2))
current_mat_out = current3
current_mat_out = np.vstack((current_mat_out, current3))

<span class="hljs-comment"># simulate network</span>
net.run(duration=<span class="hljs-number">200.</span>,
        inputs=[(neu_pre, <span class="hljs-string">&apos;r&apos;</span>, current_mat_in.T, <span class="hljs-string">&apos;=&apos;</span>),
                (neu_post, <span class="hljs-string">&apos;r&apos;</span>, current_mat_out.T)])

<span class="hljs-comment"># paint</span>
fig, gs = bp.visualize.get_figure(<span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">12</span>)

fig.add_subplot(gs[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>])
plt.plot(net.ts, neu_pre.mon.r[:, <span class="hljs-number">0</span>], <span class="hljs-string">&apos;b&apos;</span>, label=<span class="hljs-string">&apos;pre r1&apos;</span>)
plt.legend()

fig.add_subplot(gs[<span class="hljs-number">1</span>, <span class="hljs-number">0</span>])
plt.plot(net.ts, neu_pre.mon.r[:, <span class="hljs-number">1</span>], <span class="hljs-string">&apos;r&apos;</span>, label=<span class="hljs-string">&apos;pre r2&apos;</span>)
plt.legend()

fig.add_subplot(gs[<span class="hljs-number">2</span>, <span class="hljs-number">0</span>])
plt.plot(net.ts, neu_post.mon.r[:, <span class="hljs-number">0</span>], color=<span class="hljs-string">&apos;purple&apos;</span>, label=<span class="hljs-string">&apos;post r&apos;</span>)
plt.ylim([<span class="hljs-number">0</span>, <span class="hljs-number">4</span>])
plt.legend()

fig.add_subplot(gs[<span class="hljs-number">3</span>, <span class="hljs-number">0</span>])
plt.plot(net.ts, syn.mon.w[:, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>], <span class="hljs-string">&apos;b&apos;</span>, label=<span class="hljs-string">&apos;syn.w1&apos;</span>)
plt.plot(net.ts, syn.mon.w[:, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], <span class="hljs-string">&apos;r&apos;</span>, label=<span class="hljs-string">&apos;syn.w2&apos;</span>)
plt.legend()
plt.show()
</code></pre>
<p><img src="../../figs/out/output_61_0.png" alt="png"></p>
<p>&#x4ECE;&#x7ED3;&#x679C;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x4E00;&#x5F00;&#x59CB;&#x4E24;&#x7FA4;&#x795E;&#x7ECF;&#x5143;&#x540C;&#x65F6;&#x7ED9;input&#x65F6;&#xFF0C;&#x4ED6;&#x4EEC;&#x7684;weights&#x90FD;&#x4E0A;&#x5347;&#xFF0C;post&#x7684;&#x53CD;&#x5E94;&#x8D8A;&#x6765;&#x8D8A;&#x5F3A;&#xFF0C;&#x663E;&#x793A;&#x51FA;LTP&#x3002;100ms&#x540E;&#xFF0C;group1&#x4E0D;&#x518D;&#x4E00;&#x8D77;&#x53D1;&#x653E;&#xFF0C;&#x53EA;&#x6709;group2&#x7ED9;input&#xFF0C;&#x5C31;&#x53EA;&#x6709;group2&#x7684;weights&#x589E;&#x52A0;&#x3002;&#x7ED3;&#x679C;&#x7B26;&#x5408;Hebbian learning&#x7684;fire together&#xFF0C;wire together&#x3002;</p>
<h4 id="bcm&#x6CD5;&#x5219;">BCM&#x6CD5;&#x5219;</h4>
<p>BCM&#x6CD5;&#x5219;&#x7684;&#x516C;&#x5F0F;&#x5982;&#x4E0B;&#xFF1A;</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mi>d</mi><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>&#x3B7;</mi><msub><mi>v</mi><mi>i</mi></msub><mo>(</mo><msub><mi>v</mi><mi>i</mi></msub><mo>&#x2212;</mo><msub><mi>v</mi><mi>&#x3B8;</mi></msub><mo>)</mo><msub><mi>v</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">
\frac d{dt} w_{ij} =  \eta v_i(v_i - v_\theta) v_j
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">d</span><span class="mord mathit">t</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord mathit">d</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3B7;</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.02778em;">&#x3B8;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></p>
<p>&#x516C;&#x5F0F;&#x53F3;&#x8FB9;&#x753B;&#x51FA;&#x6765;&#x5982;&#x4E0B;&#x56FE;&#x6240;&#x793A;&#xFF0C;&#x5F53;&#x53D1;&#x653E;&#x9891;&#x7387;&#x9AD8;&#x4E8E;&#x9608;&#x503C;&#x65F6;&#x5448;&#x73B0;LTP&#xFF0C;&#x4F4E;&#x4E8E;&#x9608;&#x503C;&#x65F6;&#x5219;&#x4E3A;LTD&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x901A;&#x8FC7;&#x8C03;&#x6574;&#x9608;&#x503C;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x9009;&#x62E9;&#x6027;&#x3002;</p>
<p><img src="../../figs/bcm.png"></p>
<p>&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x548C;Oja&#x6CD5;&#x5219;&#x76F8;&#x540C;&#x7684;&#x8FDE;&#x63A5;&#x65B9;&#x5F0F;&#xFF0C;&#x53EA;&#x662F;&#x4E24;&#x7FA4;&#x795E;&#x7ECF;&#x5143;&#x4E3A;&#x4EA4;&#x66FF;&#x53D1;&#x653E;&#x3002;&#x5176;&#x4E2D;&#xFF0C;&#x84DD;&#x8272;&#x603B;&#x6BD4;&#x7EA2;&#x8272;&#x53D1;&#x653E;&#x66F4;&#x5F3A;&#x4E00;&#x4E9B;&#x3002;&#x52A8;&#x6001;&#x8C03;&#x6574;&#x9608;&#x503C;&#x4E3A;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">v_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#x7684;&#x65F6;&#x95F4;&#x5E73;&#x5747;&#xFF0C;&#x5373; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>v</mi><mi>&#x3B8;</mi></msub><mo>=</mo><mi>f</mi><mo>(</mo><msub><mi>v</mi><mi>i</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">v_\theta = f(v_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.02778em;">&#x3B8;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span>&#x3002;BrainPy&#x5B9E;&#x73B0;&#x7684;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF0C;&#x5728;<code>update</code>&#x51FD;&#x6570;&#x4E2D;&#x66F4;&#x65B0;&#x9608;&#x503C;&#x3002;</p>
<pre><code class="lang-python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BCM</span><span class="hljs-params">(bp.TwoEndConn)</span>:</span>
    target_backend = <span class="hljs-string">&apos;general&apos;</span>

<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">derivative</span><span class="hljs-params">(w, t, lr, r_pre, r_post, r_th)</span>:</span>
        dwdt = lr * r_post * (r_post - r_th) * r_pre
        <span class="hljs-keyword">return</span> dwdt

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, pre, post, conn, lr=<span class="hljs-number">0.005</span>, w_max=<span class="hljs-number">2.</span>, w_min=<span class="hljs-number">0.</span>, **kwargs)</span>:</span>
        <span class="hljs-comment"># parameters</span>
        self.lr = lr
        self.w_max = w_max
        self.w_min = w_min
        self.dt = bp.backend._dt

        <span class="hljs-comment"># connections</span>
        self.conn = conn(pre.size, post.size)
        self.conn_mat = conn.requires(<span class="hljs-string">&apos;conn_mat&apos;</span>)
        self.size = bp.ops.shape(self.conn_mat)

        <span class="hljs-comment"># variables</span>
        self.w = bp.ops.ones(self.size)
        self.sum_post_r = bp.ops.zeros(post.size[<span class="hljs-number">0</span>])

        self.int_w = bp.odeint(f=self.derivative, method=<span class="hljs-string">&apos;rk4&apos;</span>)

        super(BCM, self).__init__(pre=pre, post=post, **kwargs)

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span><span class="hljs-params">(self, _t)</span>:</span>
        <span class="hljs-comment"># update threshold</span>
        self.sum_post_r += self.post.r
        r_th = self.sum_post_r / (_t / self.dt + <span class="hljs-number">1</span>)

        <span class="hljs-comment"># resize to matrix</span>
        w = self.w * self.conn_mat
        dim = self.size
        r_th = bp.ops.vstack((r_th,) * dim[<span class="hljs-number">0</span>])
        r_post = bp.ops.vstack((self.post.r,) * dim[<span class="hljs-number">0</span>])
        r_pre = bp.ops.vstack((self.pre.r,) * dim[<span class="hljs-number">1</span>]).T

        <span class="hljs-comment"># update w</span>
        w = self.int_w(w, _t, self.lr, r_pre, r_post, r_th)
        self.w = bp.ops.clip(w, self.w_min, self.w_max)

        <span class="hljs-comment"># output</span>
        self.post.r = bp.ops.sum(w.T * self.pre.r, axis=<span class="hljs-number">1</span>)
</code></pre>
<pre><code class="lang-python">w_max = <span class="hljs-number">2.</span>
n_post = <span class="hljs-number">1</span>
n_pre = <span class="hljs-number">20</span>

<span class="hljs-comment"># group selection</span>
group1, duration = bp.inputs.constant_current(([<span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>]) * <span class="hljs-number">20</span>)
group2, duration = bp.inputs.constant_current(([<span class="hljs-number">0</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">1.</span>, <span class="hljs-number">1</span>]) * <span class="hljs-number">20</span>)

group1 = bp.ops.vstack((
                    (group1,)*<span class="hljs-number">10</span>))

group2 = bp.ops.vstack((
                    (group2,)*<span class="hljs-number">10</span>
                    ))
input_r = bp.ops.vstack((group1, group2))

pre = neu(n_pre, monitors=[<span class="hljs-string">&apos;r&apos;</span>])
post = neu(n_post, monitors=[<span class="hljs-string">&apos;r&apos;</span>])
bcm = BCM(pre=pre, post=post,conn=bp.connect.All2All(),
          monitors=[<span class="hljs-string">&apos;w&apos;</span>])

net = bp.Network(pre, bcm, post)
net.run(duration, inputs=(pre, <span class="hljs-string">&apos;r&apos;</span>, input_r.T, <span class="hljs-string">&quot;=&quot;</span>))

w1 = bp.ops.mean(bcm.mon.w[:, :<span class="hljs-number">10</span>, <span class="hljs-number">0</span>], <span class="hljs-number">1</span>)
w2 = bp.ops.mean(bcm.mon.w[:, <span class="hljs-number">10</span>:, <span class="hljs-number">0</span>], <span class="hljs-number">1</span>)

r1 = bp.ops.mean(pre.mon.r[:, :<span class="hljs-number">10</span>], <span class="hljs-number">1</span>)
r2 = bp.ops.mean(pre.mon.r[:, <span class="hljs-number">10</span>:], <span class="hljs-number">1</span>)
post_r = bp.ops.mean(post.mon.r[:, :], <span class="hljs-number">1</span>)

fig, gs = bp.visualize.get_figure(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">12</span>)
fig.add_subplot(gs[<span class="hljs-number">1</span>, <span class="hljs-number">0</span>], xlim=(<span class="hljs-number">0</span>, duration), ylim=(<span class="hljs-number">0</span>, w_max))
plt.plot(net.ts, w1, <span class="hljs-string">&apos;b&apos;</span>, label=<span class="hljs-string">&apos;w1&apos;</span>)
plt.plot(net.ts, w2, <span class="hljs-string">&apos;r&apos;</span>, label=<span class="hljs-string">&apos;w2&apos;</span>)
plt.title(<span class="hljs-string">&quot;weights&quot;</span>)
plt.ylabel(<span class="hljs-string">&quot;weights&quot;</span>)
plt.xlabel(<span class="hljs-string">&quot;t&quot;</span>)
plt.legend()

fig.add_subplot(gs[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>], xlim=(<span class="hljs-number">0</span>, duration))
plt.plot(net.ts, r1, <span class="hljs-string">&apos;b&apos;</span>, label=<span class="hljs-string">&apos;r1&apos;</span>)
plt.plot(net.ts, r2, <span class="hljs-string">&apos;r&apos;</span>, label=<span class="hljs-string">&apos;r2&apos;</span>)
plt.title(<span class="hljs-string">&quot;inputs&quot;</span>)
plt.ylabel(<span class="hljs-string">&quot;firing rate&quot;</span>)
plt.xlabel(<span class="hljs-string">&quot;t&quot;</span>)
plt.legend()

plt.show()
</code></pre>
<p><img src="../../figs/out/output_66_0.png" alt="png"></p>
<p>&#x7ED3;&#x679C;&#x53D1;&#x73B0;&#xFF0C;&#x5BF9;input&#x8F83;&#x5F3A;&#x7684;group 1&#x662F;LTP&#xFF0C;&#x800C;&#x5BF9;input&#x8F83;&#x5F31;&#x7684;group 2&#x662F;LTD&#xFF0C;&#x6700;&#x7EC8;&#x9009;&#x62E9;&#x4E86;group 1&#x3002;</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="dynamics.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page: 突触动力学 Synaptic Dynamics">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"突触可塑性 Synaptic Plasticity","level":"1.3.2","depth":2,"next":{"title":"网络模型 Network models","level":"1.4","depth":1,"ref":"","articles":[{"title":"发放率网络 Firing rate networks","level":"1.4.1","depth":2,"path":"networks/rate_models.md","ref":"networks/rate_models.md","articles":[]}]},"previous":{"title":"突触动力学 Synaptic Dynamics","level":"1.3.1","depth":2,"path":"synapse/dynamics.md","ref":"synapse/dynamics.md","articles":[]},"dir":"ltr"},"config":{"plugins":["-sharing","katex","code","splitter"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"katex":{},"code":{"copyButtons":true},"splitter":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"language":"ch","gitbook":"*"},"file":{"path":"synapse/plasticity.md","mtime":"2021-04-30T10:57:52.450Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-04-30T14:09:14.860Z"},"basePath":"..","book":{"language":"ch"}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-code/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

